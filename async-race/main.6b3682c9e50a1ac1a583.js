(()=>{"use strict";var t={673:(t,e,n)=>{n.d(e,{A:()=>o});var a=n(601),r=n.n(a),s=n(314),i=n.n(s)()(r());i.push([t.id,".settings {\n  display: flex;\n  flex-direction: column;\n  gap: 10px;\n  margin-bottom: 20px;\n  max-width: 380px;\n}\n\n.create-area,\n.update-area {\n  display: flex;\n  justify-content: flex-start;\n  align-items: center;\n  gap: 8px;\n}\n\n.input-text {\n  padding: 2px 8px;\n  font-size: 20px;\n  max-width: 200px;\n  width: 100%;\n  color: #fff;\n  background-color: darkcyan;\n  outline-color: gold;\n}\n\n.input-text:disabled .input-color:disabled {\n  filter: grayscale(1);\n}\n\n.input-color {\n  min-width: 50px;\n}\n\n.control-area {\n  display: flex;\n  justify-content: space-between;\n  gap: 5px;\n}\n",""]);const o=i},872:(t,e,n)=>{n.d(e,{A:()=>u});var a=n(601),r=n.n(a),s=n(314),i=n.n(s),o=n(417),l=n.n(o),c=new URL(n(553),n.b),d=i()(r()),h=l()(c);d.push([t.id,`.car-container {\n  margin-bottom: 24px;\n}\n\n.car-name {\n  font-size: 18px;\n  font-weight: 600;\n  color: white;\n  text-shadow: 0 0 4px black;\n}\n\n.road {\n  position: relative;\n  margin: 20px 0 10px;\n  min-height: 50px;\n  border-bottom: 1px dashed white;\n}\n\n.flag {\n  position: absolute;\n  top: -10px;\n  right: 100px;\n  z-index: 10;\n  width: 60px;\n  height: 60px;\n  background: url(${h}) center no-repeat;\n}\n\n.car {\n  display: block;\n  width: 102px;\n  height: 50px;\n  filter: drop-shadow(0 0 2px black);\n  overflow: hidden;\n}\n\n.button.car-button {\n  display: inline-block;\n  margin: 4px;\n  margin-left: 0;\n  max-width: 105px;\n  background-color: cyan;\n}\n\n.button.button_start {\n  background-color: chartreuse;\n}\n\n.button.button_stop {\n  background-color: crimson;\n}\n\n.button.button_select {\n  background-color: darkcyan;\n}\n\n.button.button_remove {\n  background-color: brown;\n}\n`,""]);const u=d},222:(t,e,n)=>{n.d(e,{A:()=>o});var a=n(601),r=n.n(a),s=n(314),i=n.n(s)()(r());i.push([t.id,".garage__wrapper {\n  position: relative;\n  padding: 20px;\n}\n\n.garage {\n  display: flex;\n  flex-direction: column;\n  padding: 10px 0;\n}\n\n.garage-count {\n  margin: 30px 0 10px;\n  color: white;\n  text-shadow: 0 0 4px black;\n}\n\n.garage-page {\n  margin-bottom: 20px;\n  color: white;\n}\n\n.message {\n  position: sticky;\n  bottom: 60px;\n  left: calc(50vw - 300px);\n  z-index: 999;\n  max-width: 600px;\n  border: 2px solid crimson;\n  border-radius: 10px;\n  font-size: 20px;\n  text-align: center;\n  line-height: 40px;\n  color: white;\n  background-color: tomato;\n  text-shadow: 0 0 10px black;\n}\n\n.race-result {\n  position: sticky;\n  bottom: 50vh;\n  left: calc(50vw - 150px);\n  z-index: 1000;\n  max-width: 300px;\n  border-radius: 10px;\n  font-size: 24px;\n  font-weight: bold;\n  text-align: center;\n  line-height: 44px;\n  color: goldenrod;\n  background-color: brown;\n  text-shadow: 0 0 10px yellow;\n}\n",""]);const o=i},881:(t,e,n)=>{n.d(e,{A:()=>o});var a=n(601),r=n.n(a),s=n(314),i=n.n(s)()(r());i.push([t.id,".button.button_prev,\n.button.button_next {\n  display: inline-block;\n  margin-right: 4px;\n  max-width: 70px;\n}\n",""]);const o=i},259:(t,e,n)=>{n.d(e,{A:()=>o});var a=n(601),r=n.n(a),s=n(314),i=n.n(s)()(r());i.push([t.id,".nav {\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  gap: 20px;\n  padding: 20px;\n}\n\n.button {\n  display: block;\n  padding: 5px 10px;\n  max-width: 120px;\n  width: 100%;\n  font-size: 14px;\n  font-weight: bold;\n  border: 2px solid black;\n  border-radius: 4px;\n  background-color: springgreen;\n  transition: all 0.2s ease-in-out;\n  box-shadow: 1px 1px 2px black;\n  cursor: pointer;\n}\n\n.button:active {\n  box-shadow: 1px -1px 2px black;\n  transform: translateY(2px);\n}\n\n.button:disabled {\n  filter: grayscale(1);\n  pointer-events: none;\n}\n\n@media (hover: hover) and (pointer: fine) {\n  .button:hover {\n    background-color: gold;\n  }\n}\n",""]);const o=i},708:(t,e,n)=>{n.d(e,{A:()=>o});var a=n(601),r=n.n(a),s=n(314),i=n.n(s)()(r());i.push([t.id,"* {\n  box-sizing: border-box;\n  margin: 0;\n  padding: 0;\n}\n\nbody {\n  background-color: lightslategray;\n}\n",""]);const o=i},200:(t,e,n)=>{n.d(e,{A:()=>o});var a=n(601),r=n.n(a),s=n(314),i=n.n(s)()(r());i.push([t.id,".row {\n  display: flex;\n  align-items: center;\n  max-width: 600px;\n  padding: 6px 4px;\n  text-align: center;\n  color: white;\n}\n\n.col-1 {\n  flex-basis: 90px;\n  border-right: 1px solid silver;\n}\n\n.col-2 {\n  flex-basis: 130px;\n  height: 20px;\n  border-right: 1px solid silver;\n  overflow: hidden;\n}\n\n.col-2 svg {\n  width: 40px;\n  height: 40px;\n}\n\n.col-3 {\n  flex-basis: 160px;\n  border-right: 1px solid silver;\n}\n\n.col-4 {\n  border-right: 1px solid silver;\n}\n\n.col-4,\n.col-5 {\n  flex-basis: 110px;\n}\n",""]);const o=i},426:(t,e,n)=>{n.d(e,{A:()=>o});var a=n(601),r=n.n(a),s=n(314),i=n.n(s)()(r());i.push([t.id,".winners__wrapper {\n  padding: 20px;\n}\n\n.winners-count {\n  margin: 30px 0 10px;\n  color: white;\n  text-shadow: 0 0 4px black;\n}\n\n.winners-page {\n  margin-bottom: 20px;\n  color: white;\n}\n\n.row {\n  display: flex;\n  align-items: center;\n  max-width: 600px;\n  padding: 6px 4px;\n  line-height: 21px;\n  text-align: center;\n  color: white;\n}\n\n.row_header {\n  background-color: cadetblue;\n}\n\n.row_header .col-4,\n.row_header .col-5 {\n  cursor: pointer;\n  user-select: none;\n}\n\n.row_header .active_asc::after {\n  content: ' ⬆';\n}\n\n.row_header .active_desc::after {\n  content: ' ⬇';\n}\n\n.winners-list .row:last-child {\n  margin-bottom: 30px;\n}\n\n.empty-table {\n  padding: 10px 20px;\n  color: azure;\n}\n",""]);const o=i},314:t=>{t.exports=function(t){var e=[];return e.toString=function(){return this.map((function(e){var n="",a=void 0!==e[5];return e[4]&&(n+="@supports (".concat(e[4],") {")),e[2]&&(n+="@media ".concat(e[2]," {")),a&&(n+="@layer".concat(e[5].length>0?" ".concat(e[5]):""," {")),n+=t(e),a&&(n+="}"),e[2]&&(n+="}"),e[4]&&(n+="}"),n})).join("")},e.i=function(t,n,a,r,s){"string"==typeof t&&(t=[[null,t,void 0]]);var i={};if(a)for(var o=0;o<this.length;o++){var l=this[o][0];null!=l&&(i[l]=!0)}for(var c=0;c<t.length;c++){var d=[].concat(t[c]);a&&i[d[0]]||(void 0!==s&&(void 0===d[5]||(d[1]="@layer".concat(d[5].length>0?" ".concat(d[5]):""," {").concat(d[1],"}")),d[5]=s),n&&(d[2]?(d[1]="@media ".concat(d[2]," {").concat(d[1],"}"),d[2]=n):d[2]=n),r&&(d[4]?(d[1]="@supports (".concat(d[4],") {").concat(d[1],"}"),d[4]=r):d[4]="".concat(r)),e.push(d))}},e}},417:t=>{t.exports=function(t,e){return e||(e={}),t?(t=String(t.__esModule?t.default:t),/^['"].*['"]$/.test(t)&&(t=t.slice(1,-1)),e.hash&&(t+=e.hash),/["'() \t\n]|(%20)/.test(t)||e.needQuotes?'"'.concat(t.replace(/"/g,'\\"').replace(/\n/g,"\\n"),'"'):t):t}},601:t=>{t.exports=function(t){return t[1]}},72:t=>{var e=[];function n(t){for(var n=-1,a=0;a<e.length;a++)if(e[a].identifier===t){n=a;break}return n}function a(t,a){for(var s={},i=[],o=0;o<t.length;o++){var l=t[o],c=a.base?l[0]+a.base:l[0],d=s[c]||0,h="".concat(c," ").concat(d);s[c]=d+1;var u=n(h),p={css:l[1],media:l[2],sourceMap:l[3],supports:l[4],layer:l[5]};if(-1!==u)e[u].references++,e[u].updater(p);else{var g=r(p,a);a.byIndex=o,e.splice(o,0,{identifier:h,updater:g,references:1})}i.push(h)}return i}function r(t,e){var n=e.domAPI(e);return n.update(t),function(e){if(e){if(e.css===t.css&&e.media===t.media&&e.sourceMap===t.sourceMap&&e.supports===t.supports&&e.layer===t.layer)return;n.update(t=e)}else n.remove()}}t.exports=function(t,r){var s=a(t=t||[],r=r||{});return function(t){t=t||[];for(var i=0;i<s.length;i++){var o=n(s[i]);e[o].references--}for(var l=a(t,r),c=0;c<s.length;c++){var d=n(s[c]);0===e[d].references&&(e[d].updater(),e.splice(d,1))}s=l}}},659:t=>{var e={};t.exports=function(t,n){var a=function(t){if(void 0===e[t]){var n=document.querySelector(t);if(window.HTMLIFrameElement&&n instanceof window.HTMLIFrameElement)try{n=n.contentDocument.head}catch(t){n=null}e[t]=n}return e[t]}(t);if(!a)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");a.appendChild(n)}},540:t=>{t.exports=function(t){var e=document.createElement("style");return t.setAttributes(e,t.attributes),t.insert(e,t.options),e}},56:(t,e,n)=>{t.exports=function(t){var e=n.nc;e&&t.setAttribute("nonce",e)}},825:t=>{t.exports=function(t){if("undefined"==typeof document)return{update:function(){},remove:function(){}};var e=t.insertStyleElement(t);return{update:function(n){!function(t,e,n){var a="";n.supports&&(a+="@supports (".concat(n.supports,") {")),n.media&&(a+="@media ".concat(n.media," {"));var r=void 0!==n.layer;r&&(a+="@layer".concat(n.layer.length>0?" ".concat(n.layer):""," {")),a+=n.css,r&&(a+="}"),n.media&&(a+="}"),n.supports&&(a+="}");var s=n.sourceMap;s&&"undefined"!=typeof btoa&&(a+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(s))))," */")),e.styleTagTransform(a,t,e.options)}(e,t,n)},remove:function(){!function(t){if(null===t.parentNode)return!1;t.parentNode.removeChild(t)}(e)}}}},113:t=>{t.exports=function(t,e){if(e.styleSheet)e.styleSheet.cssText=t;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(t))}}},553:(t,e,n)=>{t.exports=n.p+"assets/flag.svg"}},e={};function n(a){var r=e[a];if(void 0!==r)return r.exports;var s=e[a]={id:a,exports:{}};return t[a](s,s.exports,n),s.exports}n.m=t,n.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return n.d(e,{a:e}),e},n.d=(t,e)=>{for(var a in e)n.o(e,a)&&!n.o(t,a)&&Object.defineProperty(t,a,{enumerable:!0,get:e[a]})},n.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"==typeof window)return window}}(),n.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),(()=>{var t;n.g.importScripts&&(t=n.g.location+"");var e=n.g.document;if(!t&&e&&(e.currentScript&&(t=e.currentScript.src),!t)){var a=e.getElementsByTagName("script");if(a.length)for(var r=a.length-1;r>-1&&(!t||!/^http(s?):/.test(t));)t=a[r--].src}if(!t)throw new Error("Automatic publicPath is not supported in this browser");t=t.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),n.p=t})(),n.b=document.baseURI||self.location.href,n.nc=void 0,(()=>{const t="http://127.0.0.1:3000/garage",e="http://127.0.0.1:3000/engine",a="http://127.0.0.1:3000/winners",r=new class{async getCar(e){const n=`${t}/${e}`;return(await fetch(n)).json()}async getCars(e){const n=`${t}?_page=${e}&_limit=7`;return(await fetch(n)).json()}async getTotalCars(){const e=`${t}?_limit=7`;return(await fetch(e)).headers.get("X-Total-Count")}async createOneCar(e,n){const a=JSON.stringify({name:e,color:n});return await fetch(t,{method:"POST",headers:{"Content-Type":"application/json"},body:a})}async deleteCar(e){const n=`${t}/${e}`;await fetch(n,{method:"DELETE"})}async updateCar(e,n,a){const r=`${t}/${e}`,s=JSON.stringify({name:n,color:a});await fetch(r,{method:"PUT",headers:{"Content-Type":"application/json"},body:s})}async startCar(t){const n=`${e}?id=${t}&status=started`,a=await fetch(n,{method:"PATCH"}),{velocity:r,distance:s}=await a.json();return{velocity:r,distance:s}}async driveCar(t,n){const a=`${e}?id=${t}&status=drive`;return await fetch(a,{method:"PATCH",signal:n})}async stopCar(t){const n=`${e}?id=${t}&status=stopped`;await fetch(n,{method:"PATCH"})}async getWinner(t){return fetch(`${a}/${t}`)}async getWinners(t,e,n){const r=`${a}?_page=${t}&_limit=10&_sort=${e}&_order=${n}`;return(await fetch(r)).json()}async getTotalWinners(){const t=`${a}?_limit=10`;return(await fetch(t)).headers.get("X-Total-Count")}async createWinner({id:t,time:e,wins:n=1}){const r=JSON.stringify({id:t,wins:n,time:e});await fetch(a,{method:"POST",headers:{"Content-Type":"application/json"},body:r})}async updateWinner({id:t,time:e,wins:n}){const r=`${a}/${t}`,s=JSON.stringify({time:e,wins:n});await fetch(r,{method:"PUT",headers:{"Content-Type":"application/json"},body:s})}async deleteWinner(t){const e=`${a}/${t}`;await fetch(e,{method:"DELETE"})}};function s(t){return null==t&&console.log(`${t} is not defined`),null!==t}class i{constructor(t,...e){this.children=[];const n=document.createElement(t.tag??"div");Object.assign(n,t),t.text&&(n.textContent=t.text),this.node=n,e&&this.appendChildren(e)}getNode(){return this.node}getChildren(){return this.children}append(t){t instanceof i?(this.node.append(t.getNode()),this.children.push(t)):this.node.append(t)}appendChildren(t){t.filter(s).forEach((t=>{this.append(t)}))}text(t){this.node.textContent=t}addClass(t){this.node.classList.add(t)}removeClass(t){this.node.classList.remove(t)}toggleClass(t){this.node.classList.toggle(t)}containsClass(t){return this.node.classList.contains(t)}setAttribute(t,e){this.node.setAttribute(t,e)}removeAttribute(t){this.node.removeAttribute(t)}addEventListener(t,e,n=!1){this.node.addEventListener(t,e,n)}removeEventListener(t,e,n=!1){this.node.removeEventListener(t,e,n)}deleteChildren(){this.children.forEach((t=>{t.deleteNode()})),this.children.length=0}deleteNode(){this.deleteChildren(),this.node.remove()}}const o={page:1,totalPages:1,totalCars:"0",cars:[],winnersPage:1,totalWinnersPages:1,totalWinners:"0",winnersSort:"wins",winnersOrder:"DESC",winners:[],selectedCarId:void 0,selectedCarName:void 0,selectedCarColor:void 0,animations:{},curRacing:[],toggleSortOrder(){return this.winnersOrder="ASC"===this.winnersOrder?"DESC":"ASC",this.winnersOrder.toLowerCase()}};var l=n(72),c=n.n(l),d=n(825),h=n.n(d),u=n(659),p=n.n(u),g=n(56),m=n.n(g),w=n(540),b=n.n(w),x=n(113),f=n.n(x),v=n(881),C={};C.styleTagTransform=f(),C.setAttributes=m(),C.insert=p().bind(null,"head"),C.domAPI=h(),C.insertStyleElement=b(),c()(v.A,C),v.A&&v.A.locals&&v.A.locals;class y extends i{constructor(t,e){super({}),this.BtnPrev=new i({tag:"button",className:"button button_prev",text:"Prev",onclick:()=>{o.curRacing.length>0?e():(o.page-=1,t())}}),this.BtnNext=new i({tag:"button",className:"button button_next",text:"Next",onclick:()=>{o.curRacing.length>0?e():(o.page+=1,t())}}),this.appendChildren([this.BtnPrev,this.BtnNext])}updatePagination(){o.totalPages>1&&o.page>1?this.BtnPrev.removeAttribute("disabled"):this.BtnPrev.setAttribute("disabled","true"),o.totalPages>1&&o.page<o.totalPages?this.BtnNext.removeAttribute("disabled"):this.BtnNext.setAttribute("disabled","true")}}const N=["Alfa Romeo","Aston Martin","AUDI","BMW","Bentley","Buick","Cadillac","Chevrolet","Chrysler","Daewoo","Dodge","Ferrari","Fiat","Fisker","Ford","Honda","Hummer","Huyndai","Infinity","Jaguar","KIA","Lamborghini","Land Rover","Lexus","Mazda","Maserati","Maybach","McLaren","Mercedes","Mitsubishi","Nissan","Pontiac","Porsche","Rolls Royce","Saab","Subaru","Tesla","Toyota","Volkswagen","Volvo"],k=["Giulia","DB9","Q5","M3","Continental","Escalade","Lanos","Matiz","Challenger","Spider","Doblo","Carma","Transit","Accord","H3","Solaris","FX","RIO","Hurracan","Sport","IS300","CX5","Lancer","Quashkai","Cayene","Model S","Camry","Jetta","S60"],A=()=>{let t="#";for(let e=0;e<6;e+=1)t+="0123456789abcdef"[Math.floor(16*Math.random())];return t};var P=n(673),S={};S.styleTagTransform=f(),S.setAttributes=m(),S.insert=p().bind(null,"head"),S.domAPI=h(),S.insertStyleElement=b(),c()(P.A,S),P.A&&P.A.locals&&P.A.locals;class T extends i{constructor(t,e,n,a){super({className:"settings"}),this.CreateText=new i({tag:"input",className:"input-text",type:"text"}),this.CreateColor=new i({tag:"input",className:"input-color",type:"color"}),this.BtnCreate=new i({tag:"button",className:"button",text:"Create",onclick:()=>{o.curRacing.length>0?e():this.createHandler(t)}}),this.UpdateText=new i({tag:"input",className:"input-text",type:"text",disabled:!0}),this.UpdateColor=new i({tag:"input",className:"input-color",type:"color",disabled:!0}),this.BtnUpdate=new i({tag:"button",className:"button",text:"Update",disabled:!0,onclick:()=>{o.curRacing.length>0?e():this.updateHandler(t)}}),this.BtnRace=new i({tag:"button",className:"button",text:"Race",onclick:()=>{o.curRacing.length>0?e():a()}}),this.BtnReset=new i({tag:"button",className:"button",text:"Reset",onclick:()=>n()}),this.BtnCreateHundred=new i({tag:"button",className:"button",text:"Generate cars",onclick:()=>{o.curRacing.length>0?e():this.createHundredHandler(t)}}),this.appendChildren([new i({className:"create-area"},this.CreateText,this.CreateColor,this.BtnCreate),new i({className:"update-area"},this.UpdateText,this.UpdateColor,this.BtnUpdate),new i({className:"control-area"},this.BtnRace,this.BtnReset,this.BtnCreateHundred)])}createHandler(t){const e=this.CreateText.getNode().value,n=this.CreateColor.getNode().value;this.CreateText.getNode().value="",this.CreateColor.getNode().value="#000000",r.createOneCar(e,n).then(t)}createHundredHandler(t){let e=100;for(;e>0;)r.createOneCar(`${N[Math.floor(Math.random()*N.length)]} ${k[Math.floor(Math.random()*k.length)]}`,A()),e-=1;t()}setUpdateInputs({id:t,name:e,color:n}){return 0===t?this.clearUpdateInputs():(this.UpdateText.getNode().value=e,this.UpdateColor.getNode().value=n,this.UpdateText.removeAttribute("disabled"),this.UpdateColor.removeAttribute("disabled"),this.BtnUpdate.removeAttribute("disabled"),o.selectedCarId=t,o.selectedCarName=e,o.selectedCarColor=n,null)}clearUpdateInputs(){this.UpdateText.getNode().value="",this.UpdateColor.getNode().value="#000000",this.UpdateText.setAttribute("disabled","true"),this.UpdateColor.setAttribute("disabled","true"),this.BtnUpdate.setAttribute("disabled","true"),o.selectedCarId=void 0,o.selectedCarName=void 0,o.selectedCarColor=void 0}updateHandler(t){o.selectedCarId&&(r.updateCar(o.selectedCarId,this.UpdateText.getNode().value,this.UpdateColor.getNode().value).then(t),this.clearUpdateInputs())}}var W=n(872),B={};B.styleTagTransform=f(),B.setAttributes=m(),B.insert=p().bind(null,"head"),B.domAPI=h(),B.insertStyleElement=b(),c()(W.A,B),W.A&&W.A.locals&&W.A.locals;const $=t=>`\n  <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" width="100" height="100" viewBox="0 0 256 256" xml:space="preserve">\n  <g style="stroke: none; stroke-width: 0; stroke-dasharray: none; stroke-linecap: butt; stroke-linejoin: miter; stroke-miterlimit: 10; fill: none; fill-rule: nonzero; opacity: 1;" transform="translate(1.4 -50) scale(2.81 2.81)">\n    <path d="M 72.57 59.974 c -4.895 0 -8.877 -3.982 -8.877 -8.877 s 3.982 -8.877 8.877 -8.877 s 8.877 3.982 8.877 8.877 S 77.465 59.974 72.57 59.974 z M 72.57 45.22 c -3.24 0 -5.877 2.637 -5.877 5.877 s 2.637 5.877 5.877 5.877 s 5.877 -2.637 5.877 -5.877 S 75.811 45.22 72.57 45.22 z" style="stroke: none; stroke-width: 1; stroke-dasharray: none; stroke-linecap: butt; stroke-linejoin: miter; stroke-miterlimit: 10; fill-rule: nonzero; opacity: 1;" transform=" matrix(1 0 0 1 0 0) " stroke-linecap="round" fill="${t}" />\n    <path d="M 14.943 59.974 c -4.895 0 -8.876 -3.982 -8.876 -8.877 s 3.982 -8.877 8.876 -8.877 s 8.877 3.982 8.877 8.877 S 19.838 59.974 14.943 59.974 z M 14.943 45.22 c -3.24 0 -5.876 2.637 -5.876 5.877 s 2.636 5.877 5.876 5.877 c 3.241 0 5.877 -2.637 5.877 -5.877 S 18.184 45.22 14.943 45.22 z" style="stroke: none; stroke-width: 1; stroke-dasharray: none; stroke-linecap: butt; stroke-linejoin: miter; stroke-miterlimit: 10; fill-rule: nonzero; opacity: 1;" transform=" matrix(1 0 0 1 0 0) " stroke-linecap="round" fill="${t}" />\n    <path d="M 72.569 54.1 c -0.199 0 -0.39 -0.02 -0.59 -0.06 c -0.189 -0.04 -0.38 -0.101 -0.56 -0.17 c -0.18 -0.08 -0.351 -0.17 -0.521 -0.28 c -0.159 -0.11 -0.31 -0.23 -0.449 -0.37 c -0.561 -0.56 -0.881 -1.33 -0.881 -2.12 s 0.32 -1.569 0.881 -2.12 c 0.689 -0.699 1.729 -1.02 2.699 -0.819 c 0.2 0.029 0.391 0.09 0.57 0.17 c 0.18 0.069 0.35 0.16 0.51 0.27 c 0.17 0.11 0.32 0.24 0.46 0.38 c 0.561 0.561 0.88 1.33 0.88 2.12 s -0.319 1.561 -0.88 2.12 c -0.14 0.14 -0.29 0.26 -0.46 0.37 c -0.16 0.11 -0.33 0.2 -0.51 0.28 c -0.18 0.069 -0.37 0.13 -0.57 0.17 C 72.96 54.08 72.77 54.1 72.569 54.1 z" style="stroke: none; stroke-width: 1; stroke-dasharray: none; stroke-linecap: butt; stroke-linejoin: miter; stroke-miterlimit: 10; fill-rule: nonzero; opacity: 1;" transform=" matrix(1 0 0 1 0 0) " stroke-linecap="round" fill="${t}" />\n    <path d="M 14.94 54.1 c -0.79 0 -1.56 -0.319 -2.12 -0.88 c -0.56 -0.56 -0.88 -1.33 -0.88 -2.12 s 0.32 -1.569 0.88 -2.12 c 0.7 -0.699 1.73 -1.02 2.71 -0.819 c 0.19 0.029 0.38 0.09 0.56 0.17 c 0.18 0.069 0.36 0.16 0.52 0.27 c 0.16 0.11 0.32 0.24 0.45 0.38 c 0.14 0.13 0.27 0.29 0.38 0.45 c 0.11 0.16 0.2 0.34 0.27 0.521 c 0.08 0.18 0.14 0.369 0.17 0.56 c 0.04 0.19 0.06 0.39 0.06 0.59 c 0 0.79 -0.32 1.561 -0.88 2.12 c -0.13 0.14 -0.29 0.26 -0.45 0.37 s -0.34 0.2 -0.52 0.28 c -0.18 0.069 -0.37 0.13 -0.56 0.17 S 15.14 54.1 14.94 54.1 z" style="stroke: none; stroke-width: 1; stroke-dasharray: none; stroke-linecap: butt; stroke-linejoin: miter; stroke-miterlimit: 10; fill-rule: nonzero; opacity: 1;" transform=" matrix(1 0 0 1 0 0) " stroke-linecap="round" fill="${t}" />\n    <path d="M 81.855 39.499 l -12.382 -4.861 c -9.95 -3.529 -20.415 -5.043 -30.874 -4.505 c 0 0 -0.001 0 -0.001 0 c -4.74 0.244 -9.478 0.909 -14.167 2 l -5.124 1.524 c -0.003 0.001 -0.005 0.001 -0.008 0.002 l -6.091 1.812 c -1.269 0.295 -2.57 0.375 -3.869 0.237 l -7.682 -0.815 c -0.451 -0.048 -0.905 0.113 -1.225 0.437 c -0.32 0.325 -0.476 0.777 -0.423 1.23 l 1.553 13.185 c 0.247 2.093 1.438 3.867 3.116 4.92 c -0.39 -1.119 -0.613 -2.316 -0.613 -3.567 c 0 -5.998 4.879 -10.877 10.876 -10.877 c 5.998 0 10.877 4.879 10.877 10.877 c 0 1.645 -0.377 3.199 -1.034 4.598 h 37.94 c -0.656 -1.399 -1.033 -2.953 -1.033 -4.598 c 0 -5.998 4.879 -10.877 10.877 -10.877 s 10.877 4.879 10.877 10.877 c 0 1.645 -0.377 3.199 -1.033 4.598 h 3.339 c 2.342 0 4.247 -1.905 4.247 -4.247 C 90 46.132 86.804 41.442 81.855 39.499 z M 29.814 38.501 c -1.991 0 -3.959 -0.666 -5.541 -1.875 l -1.242 -0.95 l 2.168 -0.645 c 4.115 -0.957 8.276 -1.559 12.446 -1.833 l 2.267 5.303 H 29.814 z M 65.897 38.34 c -0.563 0.107 -1.137 0.161 -1.706 0.161 H 43.174 l -2.329 -5.45 c 9.348 -0.226 18.687 1.243 27.58 4.396 l 0.704 0.277 L 65.897 38.34 z" style="stroke: none; stroke-width: 1; stroke-dasharray: none; stroke-linecap: butt; stroke-linejoin: miter; stroke-miterlimit: 10; fill-rule: nonzero; opacity: 1;" transform=" matrix(1 0 0 1 0 0) " stroke-linecap="round" fill="${t}" />\n  </g>\n  </svg>\n`;class M extends i{constructor({id:t,name:e,color:n},a,r,s){super({id:String(t),className:"car-container"},new i({tag:"span",className:"car-name",text:e})),this.controller=new AbortController,this.CarImg=new i({className:"car"}),this.CarImg.getNode().innerHTML=$(n),this.Road=new i({className:"road"},this.CarImg,new i({className:"flag"})),this.BtnStart=new i({tag:"button",className:"button car-button button_start",text:"Start",onclick:t=>{const e=this.getId(t);this.startHandler(e)}}),this.BtnStop=new i({tag:"button",className:"button car-button button_stop",text:"Stop/Back",disabled:!0,onclick:t=>{const e=this.getId(t);this.stopHandler(e)}}),this.BtnSelect=new i({tag:"button",className:"button car-button button_select",text:"Select",onclick:t=>{o.curRacing.length>0?s():this.selectHandler(t,r)}}),this.BtnRemove=new i({tag:"button",className:"button car-button button_remove",text:"Remove",onclick:t=>{o.curRacing.length>0?s():this.removeHandler(t,a,r)}}),this.appendChildren([this.Road,this.BtnStart,this.BtnStop,this.BtnSelect,this.BtnRemove])}getId(t){const e=t.target;return Number(e.closest("div")?.getAttribute("id"))}async removeHandler(t,e,n){const a=this.getId(t);await r.deleteWinner(a),r.deleteCar(a).then(e).then((()=>{0===o.cars.length&&o.page>1&&(o.page-=1,e())})).then((()=>{a===o.selectedCarId&&n({id:0,name:"",color:""})}))}selectHandler(t,e){const n=this.getId(t),{name:a,color:r}=o.cars.find((t=>t.id===n));e({id:n,name:a,color:r})}async startHandler(t){this.controller=new AbortController,this.BtnStart.setAttribute("disabled","true"),this.BtnStop.removeAttribute("disabled"),o.curRacing.push(t);const e=this.CarImg.getNode(),n=this.Road.getNode().clientWidth-e.offsetWidth,{velocity:a,distance:s}=await r.startCar(t),i=+(s/a/1e3).toFixed(2);return this.animateCar(a,s,t,n),new Promise((e=>{r.driveCar(t,this.controller.signal).then((n=>{if(200!==n.status)throw Error(`Car id#${t} engine fail`);e({id:t,time:i})})).catch((()=>window.cancelAnimationFrame(o.animations[t])))}))}animateCar(t,e,n,a){const r=e/t;let s,i=!1;const l=this.CarImg.getNode(),c=a/r,d=window.requestAnimationFrame((function t(e){void 0===s&&(s=e);const r=e-s;if(void 0!==e){const t=Math.min(c*r,a);l.style.transform=`translateX(${t}px)`,t===a&&(i=!0)}if(!i){const e=window.requestAnimationFrame(t);o.animations[n]=e}}));o.animations[n]=d}async stopHandler(t){await r.stopCar(t),window.cancelAnimationFrame(o.animations[t]),this.CarImg.getNode().style.transform="translateX(0)",this.controller.abort(),this.BtnStart.removeAttribute("disabled"),this.BtnStop.setAttribute("disabled","true"),o.curRacing=o.curRacing.filter((e=>e!==t))}}var _=n(222),I={};I.styleTagTransform=f(),I.setAttributes=m(),I.insert=p().bind(null,"head"),I.domAPI=h(),I.insertStyleElement=b(),c()(_.A,I),_.A&&_.A.locals&&_.A.locals;class E extends i{constructor(t){super({className:"garage__wrapper"}),this.rerenderWinnersTable=t,this.Settings=new T((()=>this.render()),(()=>this.showReturnMessage()),(()=>this.resetCallback()),(()=>this.raceCallback())),this.Garage=new i({className:"garage"}),this.CarsCounter=new i({tag:"h2",className:"garage-count"}),this.PageCounter=new i({tag:"h3",className:"garage-page"}),this.Pagination=((t,e)=>new y((()=>this.render()),(()=>this.showReturnMessage())))(),this.appendChildren([this.Settings,this.CarsCounter,this.PageCounter,this.Garage,this.Pagination]),this.render()}async render(){await async function(){o.cars=await r.getCars(o.page),o.totalCars=await r.getTotalCars(),o.totalPages=Math.ceil(+o.totalCars/7)}(),this.renderGarageCounter(),this.renderCars(),this.Pagination.updatePagination()}renderCars(){this.Garage.deleteChildren(),o.cars.forEach((t=>this.Garage.append((({id:t,name:e,color:n},a,r,s)=>new M({id:t,name:e,color:n},(()=>this.render()),r,(()=>this.showReturnMessage())))({id:t.id,name:t.name,color:t.color},0,(t=>this.Settings.setUpdateInputs(t))))))}renderGarageCounter(){this.CarsCounter.text(`Garage (${o.totalCars})`),this.PageCounter.text(`Page # ${o.page} / ${o.totalPages}`)}showReturnMessage(){if(this.getChildren().length>5)return;const t=new i({tag:"p",className:"message",text:"Return all cars to garage"});this.append(t),setTimeout((()=>{t.deleteNode(),this.getChildren().pop()}),2e3)}resetCallback(){this.Garage.getChildren().forEach((t=>{const e=+t.getNode().id;t.stopHandler(e)}))}async raceCallback(){const t=this.Garage.getChildren().map((t=>{const e=Number(t.getNode().id);return t.startHandler(e)})),{id:e,time:n}=await Promise.any(t),{name:a}=o.cars.find((t=>t.id===e)),s=document.createElement("p");s.className="race-result",s.textContent=`${a} wins in ${n} sec`,this.append(s),setTimeout((()=>s.remove()),5e3);const i=await r.getWinner(e);200===i.status&&await this.updateWinner(e,n,i),404===i.status&&await this.createWinner({id:e,time:n}),this.rerenderWinnersTable()}async createWinner({id:t,time:e}){await r.createWinner({id:t,time:e})}async updateWinner(t,e,n){let{id:a,time:s,wins:i}=await n.json();s>e&&(s=e),i+=1,a=t,await r.updateWinner({id:a,time:s,wins:i})}}var R=n(200),H={};H.styleTagTransform=f(),H.setAttributes=m(),H.insert=p().bind(null,"head"),H.domAPI=h(),H.insertStyleElement=b(),c()(R.A,H),R.A&&R.A.locals&&R.A.locals;class L extends i{constructor({color:t,name:e,wins:n,time:a},r){const s=new i({className:"col-2"});s.getNode().innerHTML=$(t),super({className:"row"},new i({className:"col-1",text:String(r)}),s,new i({className:"col-3",text:e}),new i({className:"col-4",text:String(n)}),new i({className:"col-5",text:String(a)}))}}var U=n(426),z={};z.styleTagTransform=f(),z.setAttributes=m(),z.insert=p().bind(null,"head"),z.domAPI=h(),z.insertStyleElement=b(),c()(U.A,z),U.A&&U.A.locals&&U.A.locals;class j extends i{constructor(t){super({}),this.BtnPrev=new i({tag:"button",className:"button button_prev",text:"Prev",onclick:()=>{o.winnersPage-=1,t()}}),this.BtnNext=new i({tag:"button",className:"button button_next",text:"Next",onclick:()=>{o.winnersPage+=1,t()}}),this.appendChildren([this.BtnPrev,this.BtnNext])}updatePagination(){o.totalWinnersPages>1&&o.winnersPage>1?this.BtnPrev.removeAttribute("disabled"):this.BtnPrev.setAttribute("disabled","true"),o.totalWinnersPages>1&&o.winnersPage<o.totalWinnersPages?this.BtnNext.removeAttribute("disabled"):this.BtnNext.setAttribute("disabled","true")}}class O extends i{constructor(){super({className:"winners__wrapper"}),this.WinnersCounter=new i({tag:"h2",className:"winners-count"}),this.PageCounter=new i({tag:"h3",className:"winners-page"}),this.WinnersList=new i({tag:"ul",className:"winners-list"}),this.WinsSort=new i({className:"col-4",text:"Wins"}),this.WinsSort.addEventListener("click",(()=>{o.winnersSort="wins";const t=o.toggleSortOrder();this.WinsSort.getNode().className="col-4",this.WinsSort.addClass(`active_${t}`),this.TimeSort.getNode().className="col-5",this.render()})),this.TimeSort=new i({className:"col-5",text:"Best time"}),this.TimeSort.addEventListener("click",(()=>{o.winnersSort="time";const t=o.toggleSortOrder();this.TimeSort.getNode().className="col-5",this.TimeSort.addClass(`active_${t}`),this.WinsSort.getNode().className="col-4",this.render()}));const t=new i({className:"row row_header"},new i({className:"col-1",text:"Number"}),new i({className:"col-2",text:"Car"}),new i({className:"col-3",text:"Name"}),this.WinsSort,this.TimeSort);this.Pagination=new j((()=>this.render())),this.appendChildren([this.WinnersCounter,this.PageCounter,t,this.WinnersList,this.Pagination])}async render(){await async function(){const t=await r.getWinners(o.winnersPage,o.winnersSort,o.winnersOrder),e=[];t.forEach((t=>{e.push(r.getCar(t.id))}));const n=await Promise.all(e),a=[];t.forEach((t=>{const e=n.find((e=>e.id===t.id));if(!e)return;const{color:r,name:s}=e,i=t.wins,{time:o}=t;a.push({color:r,name:s,wins:i,time:o})})),o.winners=a,o.totalWinners=await r.getTotalWinners(),o.totalWinnersPages=Math.ceil(+o.totalWinners/10)}(),this.renderWinnersCounter(),this.renderWinners(),this.Pagination.updatePagination()}renderWinnersCounter(){this.WinnersCounter.text(`Winners (${o.totalWinners})`),this.PageCounter.text(`Page # ${o.winnersPage} / ${o.totalWinnersPages}`)}renderWinners(){this.WinnersList.deleteChildren();const t=o.winners.map(((t,e)=>{return n={color:t.color,name:t.name,wins:t.wins,time:t.time},a=e+1+10*(o.winnersPage-1),new L(n,a);var n,a}));0!==t.length?this.WinnersList.appendChildren(t):this.WinnersList.append(new i({className:"empty-table",text:"No winners yet"}))}}var G=n(259),F={};F.styleTagTransform=f(),F.setAttributes=m(),F.insert=p().bind(null,"head"),F.domAPI=h(),F.insertStyleElement=b(),c()(G.A,F),G.A&&G.A.locals&&G.A.locals;class D extends i{constructor(t,e){super({tag:"nav",className:"nav"}),this.ButtonGarage=new i({tag:"button",className:"button",text:"To Garage",onclick:()=>t()}),this.ButtonWinners=new i({tag:"button",className:"button",text:"To Winners",onclick:()=>e()}),this.appendChildren([this.ButtonGarage,this.ButtonWinners])}}var J=n(708),X={};X.styleTagTransform=f(),X.setAttributes=m(),X.insert=p().bind(null,"head"),X.domAPI=h(),X.insertStyleElement=b(),c()(J.A,X),J.A&&J.A.locals&&J.A.locals;const q=document.querySelector("body");new class{constructor(t){this.root=t,this.GaragePage=new E((()=>this.WinnerPage.render())),this.WinnerPage=new O}start(){var t,e;this.root.append((t=this.showGarage.bind(this),e=this.showWinners.bind(this),new D(t,e)).getNode()),this.root.append(this.GaragePage.getNode())}showGarage(){this.WinnerPage.getNode().remove(),this.root.append(this.GaragePage.getNode())}showWinners(){this.GaragePage.getNode().remove(),this.root.append(this.WinnerPage.getNode()),this.WinnerPage.render()}}(q).start()})()})();