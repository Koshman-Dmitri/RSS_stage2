(()=>{"use strict";var e={186:(e,t,n)=>{n.d(t,{A:()=>o});var s=n(601),i=n.n(s),a=n(314),r=n.n(a)()(i());r.push([e.id,"* {\n  padding: 0px;\n  margin: 0px;\n  border: none;\n  box-sizing: border-box;\n}\n\na,\na:link,\na:visited,\na:hover {\n  color: inherit;\n  text-decoration: none;\n}\n\nhtml {\n  height: 100svh;\n  font-family: Verdana, Tahoma, sans-serif;\n  font-size: 20px;\n}\n\nbody {\n  height: 100svh;\n  background-image: linear-gradient(90deg, #16032b 0%, #f76b1c 100%);\n}\n\n.container {\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  margin: 0 auto;\n  padding: 10px 20px;\n  max-width: 1440px;\n  height: 100svh;\n}\n\n.container:has(.fun-chat) {\n  align-items: initial;\n}\n\n@media (max-width: 679px) {\n  html {\n    font-size: 16px;\n  }\n}\n",""]);const o=r},711:(e,t,n)=>{n.d(t,{A:()=>o});var s=n(601),i=n.n(s),a=n(314),r=n.n(a)()(i());r.push([e.id,".connection-error__overlay {\n  position: absolute;\n  top: 0;\n  left: 0;\n  right: 0;\n  bottom: 0;\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  backdrop-filter: blur(2px);\n}\n\n.connection-error__wrapper {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  gap: 20px;\n  padding: 20px 26px;\n  max-width: max-content;\n  font-size: 1rem;\n  border: 2px solid purple;\n  border-radius: 10px;\n  text-align: left;\n  color: #fff;\n  text-shadow: 1px 1px 4px black;\n  background-color: darkgray;\n}\n\n.loader {\n  display: inline-block;\n  width: 40px;\n  height: 40px;\n  border: 5px dotted #fff;\n  border-radius: 50%;\n  animation: rotation 2s linear infinite;\n}\n\n@keyframes rotation {\n  0% {\n    transform: rotate(0deg);\n  }\n  100% {\n    transform: rotate(360deg);\n  }\n}\n\n.connection-error__message > p:first-child {\n  margin-bottom: 4px;\n}\n",""]);const o=r},955:(e,t,n)=>{n.d(t,{A:()=>o});var s=n(601),i=n.n(s),a=n(314),r=n.n(a)()(i());r.push([e.id,".delimeter {\n  position: relative;\n  padding-bottom: 3px;\n  width: 100%;\n  font-size: 0.8em;\n  text-align: center;\n  border-bottom: 1px dashed yellow;\n  color: yellow;\n}\n\n.delimeter:first-child {\n  margin-top: auto;\n}\n",""]);const o=r},133:(e,t,n)=>{n.d(t,{A:()=>o});var s=n(601),i=n.n(s),a=n(314),r=n.n(a)()(i());r.push([e.id,".overlay {\n  position: absolute;\n  top: 0;\n  left: 0;\n  right: 0;\n  bottom: 0;\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  backdrop-filter: blur(2px);\n}\n\n.popup-auth-error {\n  padding: 10px 16px;\n  max-width: max-content;\n  font-size: 1rem;\n  border: 2px solid purple;\n  border-radius: 10px;\n  text-align: center;\n  color: #fff;\n  text-shadow: 1px 1px 4px black;\n  background-color: darkgray;\n}\n\n.loader {\n  display: inline-block;\n  width: 40px;\n  height: 40px;\n  border: 5px dotted #fff;\n  border-radius: 50%;\n  animation: rotation 2s linear infinite;\n}\n\n@keyframes rotation {\n  0% {\n    transform: rotate(0deg);\n  }\n  100% {\n    transform: rotate(360deg);\n  }\n}\n",""]);const o=r},319:(e,t,n)=>{n.d(t,{A:()=>o});var s=n(601),i=n.n(s),a=n(314),r=n.n(a)()(i());r.push([e.id,".about {\n  padding: 30px 40px;\n  max-width: 800px;\n  width: 100%;\n  border: thick double mediumpurple;\n  border-radius: 14px;\n  color: indigo;\n  text-shadow: 0 0 4px white;\n}\n\n.about__title {\n  margin-bottom: 20px;\n  font-size: 1.2rem;\n  text-align: center;\n  text-shadow: 0 0 4px indigo;\n  text-decoration: underline;\n  color: white;\n}\n\n.about__description {\n  color: white;\n  text-align: center;\n}\n\n.description__accent {\n  color: mediumpurple;\n  text-shadow: none;\n}\n\n.about__button {\n  display: block;\n  margin: 30px auto 0;\n  padding: 8px;\n  max-width: 160px;\n  width: 100%;\n  font-family: inherit;\n  font-size: 1rem;\n  font-style: normal;\n  font-weight: 400;\n  color: #fff;\n  border-radius: 6px;\n  background-color: mediumpurple;\n  box-shadow: 1px 1px 4px black;\n  cursor: pointer;\n  transition: all 0.3s ease-in-out;\n}\n\n.about__button:active {\n  transform: translateY(2px);\n}\n\n@media (hover: hover) and (pointer: fine) {\n  .about__button:hover {\n    background-color: #fff;\n    color: mediumpurple;\n  }\n}\n\n@media (max-width: 679px) {\n  .about__button {\n    max-width: 100px;\n  }\n}\n",""]);const o=r},823:(e,t,n)=>{n.d(t,{A:()=>o});var s=n(601),i=n.n(s),a=n(314),r=n.n(a)()(i());r.push([e.id,".authorization-form {\n  padding: 30px 26px;\n  max-width: 500px;\n  width: 100%;\n  border: thick double mediumpurple;\n  border-radius: 14px;\n  color: indigo;\n  text-shadow: 0 0 5px white;\n}\n\n.auth-form__title {\n  margin-bottom: 20px;\n  font-size: 24px;\n  text-align: center;\n  text-shadow: 0 0 4px indigo;\n  text-decoration: underline;\n  color: white;\n}\n\n.auth-form__input-wrapper {\n  display: flex;\n  align-items: center;\n  margin-bottom: 12px;\n}\n\n.auth-form__label {\n  max-width: 120px;\n  width: 100%;\n  font-size: 20px;\n}\n\n.auth-form__input {\n  padding: 4px 10px;\n  max-width: 70%;\n  width: 100%;\n  font-size: 20px;\n  border: 2px solid transparent;\n  border-radius: 8px;\n  outline: none;\n  color: inherit;\n}\n\n.auth-form__input:focus {\n  border: 2px solid mediumpurple;\n}\n\n.auth-form__input::placeholder {\n  font-size: 16px;\n}\n\n.auth-form__input.error:invalid {\n  border: 2px solid red;\n  animation: invalidInput 0.4s 1;\n  animation-fill-mode: backwards;\n}\n\n@keyframes invalidInput {\n  0% {\n    transform: translateX(0px);\n  }\n  20% {\n    transform: translateX(2px);\n  }\n  40% {\n    transform: translateX(-2px);\n  }\n  60% {\n    transform: translateX(2px);\n  }\n  80% {\n    transform: translateX(-2px);\n  }\n  100% {\n    transform: translateX(0);\n  }\n}\n\n.auth-form__button {\n  display: block;\n  margin: 12px auto 0;\n  padding: 8px;\n  max-width: 160px;\n  width: 100%;\n  font-family: inherit;\n  font-size: 20px;\n  font-style: normal;\n  font-weight: 400;\n  color: #fff;\n  border-radius: 6px;\n  background-color: mediumpurple;\n  box-shadow: 1px 1px 4px black;\n  cursor: pointer;\n  transition: all 0.3s ease-in-out;\n}\n\n.auth-form__button:first-of-type {\n  margin-top: 20px;\n}\n\n.auth-form__button:disabled {\n  pointer-events: none;\n  filter: grayscale(1);\n}\n\n.auth-form__button:active {\n  transform: translateY(2px);\n}\n\n@media (hover: hover) and (pointer: fine) {\n  .auth-form__button:hover {\n    background-color: #fff;\n    color: mediumpurple;\n  }\n}\n",""]);const o=r},35:(e,t,n)=>{n.d(t,{A:()=>o});var s=n(601),i=n.n(s),a=n(314),r=n.n(a)()(i());r.push([e.id,".message {\n  display: flex;\n  flex-direction: column;\n  justify-content: center;\n  align-items: center;\n  padding: 6px 10px;\n  max-width: 80%;\n  font-size: 0.6rem;\n  border-radius: 14px;\n  background: linear-gradient(315deg, rgba(12, 12, 14, 1) 0%, rgba(132, 59, 191, 1) 50%, rgba(12, 12, 14, 1) 100%);\n}\n\n.message:first-child {\n  margin-top: auto;\n}\n\n.message.in {\n  align-self: flex-start;\n}\n\n.message.out {\n  align-self: flex-end;\n}\n\n.message__header,\n.message__footer {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  gap: 10px;\n  padding: 0 10%;\n  width: 100%;\n  min-width: max-content;\n}\n\n.message__header {\n  padding-bottom: 6px;\n}\n\n.message__username,\n.message__edit {\n  max-width: 40%;\n  word-break: break-all;\n}\n\n.message__data,\n.message__status {\n  max-width: 55%;\n}\n\n.message__data {\n  min-width: fit-content;\n}\n\n.message__text {\n  padding: 10px 4px;\n  width: 100%;\n  font-size: 1rem;\n  border-radius: 8px;\n  background: linear-gradient(225deg, rgba(65, 64, 64, 1) 0%, rgba(147, 112, 219, 1) 50%, rgba(91, 91, 91, 1) 100%);\n  word-break: break-word;\n}\n\n.message__footer {\n  padding-top: 6px;\n}\n\n@media (hover: hover) and (pointer: fine) {\n  .message.out {\n    cursor: pointer;\n  }\n}\n\n@media (max-width: 679px) {\n  .message__header {\n    flex-wrap: wrap;\n    gap: 5px;\n    padding: 0;\n    padding-bottom: 6px;\n    min-width: unset;\n  }\n\n  .message__username,\n  .message__data {\n    max-width: unset;\n  }\n}\n",""]);const o=r},341:(e,t,n)=>{n.d(t,{A:()=>u});var s=n(601),i=n.n(s),a=n(314),r=n.n(a),o=n(417),d=n.n(o),l=new URL(n(394),n.b),c=r()(i()),h=d()(l);c.push([e.id,`.chat__window {\n  display: flex;\n  flex-direction: column;\n  justify-content: space-between;\n  align-items: center;\n  padding: 0 6px;\n  width: 64%;\n  height: 100%;\n  overflow-y: auto;\n}\n\n.window__header {\n  display: flex;\n  justify-content: space-around;\n  align-items: center;\n  gap: 20px;\n  padding: 4px 6px;\n  width: 100%;\n  height: 8%;\n  min-height: 40px;\n  border-bottom: 2px solid white;\n  border-radius: 10%;\n}\n\n.reciever__name {\n  filter: drop-shadow(0 0 4px indigo);\n  word-break: break-word;\n}\n\n.reciever__status_online {\n  color: lawngreen;\n  filter: drop-shadow(0 0 1px indigo);\n}\n\n.reciever__status_offline {\n  color: maroon;\n  filter: drop-shadow(0 0 1px indigo);\n}\n\n.window__main {\n  position: relative;\n  display: flex;\n  flex-direction: column;\n  justify-content: flex-start;\n  align-items: center;\n  gap: 10px;\n  padding: 12px 6px;\n  width: 100%;\n  height: 82%;\n  overflow-x: hidden;\n  overflow-y: auto;\n  scrollbar-width: thin;\n}\n\n.window__main:has(.chat__start-message) {\n  justify-content: center;\n}\n\n.chat__start-message {\n  text-align: center;\n}\n\n.window__footer {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  padding: 2px 6px;\n  width: 100%;\n  height: 10%;\n  min-height: 40px;\n  border-top: 2px solid white;\n  border-radius: 10%;\n}\n\n.message-input {\n  padding: 4px 36px 4px 8px;\n  width: 100%;\n  font-size: 0.9rem;\n  border: 2px solid transparent;\n  border-radius: 6px;\n  color: indigo;\n  outline: none;\n}\n\n.message-input:focus {\n  border: 2px solid mediumpurple;\n}\n\n.message-input::placeholder {\n  font-size: 0.9em;\n}\n\n.cancel-edit {\n  position: relative;\n  right: 30px;\n  width: 20px;\n  font-size: 0.6rem;\n  text-align: center;\n  border: 1px solid mediumpurple;\n  border-radius: 50%;\n  color: indigo;\n  visibility: visible;\n  cursor: pointer;\n}\n\n.cancel-edit.hidden {\n  visibility: hidden;\n}\n\n.message-button-send {\n  flex-shrink: 0;\n  width: 30px;\n  height: 30px;\n  background: url(${h}) center no-repeat;\n  filter: contrast(2);\n  cursor: pointer;\n}\n\n.message-button-send:disabled {\n  pointer-events: none;\n  filter: grayscale(0.5);\n}\n\n/* === Popup context menu === */\n\n.popup-context {\n  position: absolute;\n  right: 10%;\n  margin: 0 auto;\n  padding: 10px;\n  min-width: max-content;\n  max-width: 100px;\n  width: 100%;\n  font-size: 1rem;\n  border: 2px solid purple;\n  border-radius: 10px;\n  text-align: left;\n  text-shadow: 1px 1px 4px black;\n  color: #fff;\n  background-color: darkgray;\n  cursor: default;\n}\n\n.popup-context span {\n  display: block;\n  transition: background-color 0.2s ease-in-out;\n}\n\n.popup-context span + span {\n  margin-top: 5px;\n}\n\n@media (hover: hover) and (pointer: fine) {\n  .popup-context span {\n    cursor: pointer;\n  }\n\n  .popup-context span:hover {\n    background-color: indigo;\n  }\n}\n`,""]);const u=c},15:(e,t,n)=>{n.d(t,{A:()=>u});var s=n(601),i=n.n(s),a=n(314),r=n.n(a),o=n(417),d=n.n(o),l=new URL(n(724),n.b),c=r()(i()),h=d()(l);c.push([e.id,`.footer {\n  display: flex;\n  justify-content: space-around;\n  align-items: center;\n  column-gap: 20px;\n  padding: 10px 25px;\n  max-height: 70px;\n  height: 10svh;\n  min-height: 70px;\n  border-radius: 0 0 30px 30px;\n  text-align: center;\n  text-shadow: 0 0 4px indigo;\n}\n\n.footer__link {\n  transition: all 0.3s ease;\n}\n\n.link_git::after {\n  display: block;\n  content: '';\n  margin-top: 2px;\n  width: 0;\n  height: 2px;\n  background-color: mediumpurple;\n  transition: width 0.3s ease-in-out;\n}\n\n.rs-school__wrapper {\n  width: 100px;\n  min-width: 90px;\n  height: 100%;\n}\n\n.link_rs-school {\n  display: block;\n  width: 100%;\n  height: 80%;\n  background: url(${h}) center no-repeat;\n  transition: filter 0.3s ease-in-out;\n}\n\n.rs-school__title {\n  margin-top: 2px;\n  font-size: 12px;\n  letter-spacing: 0.5px;\n  color: #fff;\n}\n\n@media (hover: hover) and (pointer: fine) {\n  .footer__link:hover::after {\n    width: 100%;\n  }\n\n  .link_rs-school:hover {\n    filter: drop-shadow(0 0 2px white);\n  }\n}\n`,""]);const u=c},59:(e,t,n)=>{n.d(t,{A:()=>o});var s=n(601),i=n.n(s),a=n(314),r=n.n(a)()(i());r.push([e.id,".header {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  gap: 10px;\n  padding: 10px 25px;\n  max-height: 70px;\n  height: 10svh;\n  min-height: 70px;\n  border-radius: 30px 30px 0 0;\n}\n\n.title-wrapper {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  gap: 10px;\n}\n\n.header__title {\n  font-size: 1.4rem;\n}\n\n.link_about {\n  width: 1.4rem;\n  min-width: 1.4rem;\n  font-family: inherit;\n  font-size: 1rem;\n  line-height: 1.4rem;\n  text-align: center;\n  border-radius: 50%;\n  color: inherit;\n  background-color: mediumpurple;\n  text-shadow: none;\n  cursor: pointer;\n  transition:\n    color 0.3s ease-in-out,\n    background-color 0.3s ease-in-out;\n}\n\n.username {\n  max-width: 100%;\n  max-height: 48px;\n  word-break: break-all;\n  overflow: auto;\n  filter: drop-shadow(0 0 4px indigo);\n}\n\n.header__button_logout {\n  padding: 8px;\n  max-width: 100px;\n  width: 100%;\n  font-family: inherit;\n  font-size: 1rem;\n  color: #fff;\n  border-radius: 6px;\n  background-color: mediumpurple;\n  box-shadow: 1px 1px 4px black;\n  cursor: pointer;\n  transition: all 0.3s ease-in-out;\n}\n\n.header__button_logout:active {\n  transform: translateY(2px);\n}\n\n@media (hover: hover) and (pointer: fine) {\n  .link_about:hover {\n    color: blueviolet;\n    background-color: white;\n  }\n\n  .header__button_logout:hover {\n    background-color: #fff;\n    color: mediumpurple;\n  }\n}\n\n@media (max-width: 679px) {\n  .header__title {\n    max-width: min-content;\n  }\n\n  .header__button_logout {\n    max-width: 70px;\n  }\n}\n",""]);const o=r},547:(e,t,n)=>{n.d(t,{A:()=>o});var s=n(601),i=n.n(s),a=n(314),r=n.n(a)()(i());r.push([e.id,".fun-chat {\n  width: 100%;\n}\n\n.header,\n.chat,\n.footer {\n  width: 100%;\n  box-shadow: 0 0 6px white;\n  color: white;\n  text-shadow: 0 0 4px indigo;\n  font-size: 1rem;\n}\n\n.chat {\n  flex-grow: 1;\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  margin: 10px 0;\n  padding: 5px;\n  height: 80svh;\n  text-shadow: none;\n}\n",""]);const o=r},36:(e,t,n)=>{n.d(t,{A:()=>o});var s=n(601),i=n.n(s),a=n(314),r=n.n(a)()(i());r.push([e.id,".list__user {\n  display: flex;\n  align-items: center;\n  padding: 4px;\n  transition:\n    opacity 0.2s ease-in,\n    color 0.2s ease-in;\n  cursor: pointer;\n}\n\n.list__user.hidden {\n  display: none;\n}\n\n.list__user-status {\n  flex-shrink: 0;\n  margin-right: 10px;\n  width: 10px;\n  height: 10px;\n  border-radius: 50%;\n}\n\n.list__user.online .list__user-status {\n  background-color: limegreen;\n}\n\n.list__user.offline .list__user-status {\n  background-color: crimson;\n}\n\n.list__user-name {\n  margin-right: 10px;\n  width: 90%;\n  word-break: break-all;\n}\n\n.list__unwritten {\n  flex-shrink: 0;\n  margin-left: auto;\n  margin-right: 4px;\n  width: 24px;\n  height: 24px;\n  font-size: 0.6rem;\n  line-height: 1.7;\n  text-align: center;\n  border-radius: 50%;\n  border: 2px solid limegreen;\n  background-color: rgba(0, 128, 0, 0.7);\n}\n\n@media (hover: hover) and (pointer: fine) {\n  .users__list:has(.list__user:hover) > :not(:hover) {\n    opacity: 0.4;\n  }\n\n  .users__list:has(.list__user:hover) > :hover {\n    color: mediumpurple;\n  }\n\n  .users__list:has(.list__user:hover) > :hover .list__unwritten {\n    color: white;\n  }\n}\n\n@media (max-width: 679px) {\n  .list__unwritten {\n    line-height: 2;\n  }\n}\n",""]);const o=r},667:(e,t,n)=>{n.d(t,{A:()=>o});var s=n(601),i=n.n(s),a=n(314),r=n.n(a)()(i());r.push([e.id,".chat__users {\n  display: flex;\n  flex-direction: column;\n  padding: 10px 5px;\n  width: 35%;\n  height: 100%;\n  border-right: 2px solid white;\n  border-radius: 3%;\n}\n\n.chat__filter {\n  margin: 0 auto;\n  margin-bottom: 8px;\n  padding: 4px 8px;\n  width: 96%;\n  font-size: 0.9rem;\n  border: 2px solid transparent;\n  border-radius: 6px;\n  color: indigo;\n  outline: none;\n}\n\n.chat__filter:focus {\n  border: 2px solid mediumpurple;\n}\n\n.chat__filter::placeholder {\n  font-size: 0.9em;\n}\n\n.users__list {\n  padding-left: 8px;\n  height: 100%;\n  list-style: none;\n  overflow-y: auto;\n  overflow-x: hidden;\n  scrollbar-width: thin;\n}\n\n@media (max-width: 679px) {\n  .chat__users {\n    padding: 10px 0;\n  }\n\n  .users__list {\n    padding-left: 0;\n  }\n}\n",""]);const o=r},987:(e,t,n)=>{n.d(t,{A:()=>o});var s=n(601),i=n.n(s),a=n(314),r=n.n(a)()(i());r.push([e.id,".page-not-found {\n  padding: 30px 40px;\n  max-width: 800px;\n  width: 100%;\n  border: thick double mediumpurple;\n  border-radius: 14px;\n  color: indigo;\n  text-shadow: 0 0 4px white;\n}\n\n.not-found__title {\n  margin-bottom: 20px;\n  font-size: 1.2rem;\n  font-weight: bold;\n  text-align: center;\n  text-shadow: 0 0 4px indigo;\n  color: white;\n}\n\n.not-found__description {\n  color: white;\n  text-align: center;\n}\n\n.not-found__button {\n  display: block;\n  margin: 30px auto 0;\n  padding: 8px;\n  max-width: 160px;\n  width: 100%;\n  font-family: inherit;\n  font-size: 1rem;\n  font-style: normal;\n  font-weight: 400;\n  color: #fff;\n  border-radius: 6px;\n  background-color: mediumpurple;\n  box-shadow: 1px 1px 4px black;\n  cursor: pointer;\n  transition: all 0.3s ease-in-out;\n}\n\n.not-found__button:active {\n  transform: translateY(2px);\n}\n\n@media (hover: hover) and (pointer: fine) {\n  .not-found__button:hover {\n    background-color: #fff;\n    color: mediumpurple;\n  }\n}\n\n@media (max-width: 679px) {\n  .not-found__button {\n    max-width: 100px;\n  }\n}\n",""]);const o=r},314:e=>{e.exports=function(e){var t=[];return t.toString=function(){return this.map((function(t){var n="",s=void 0!==t[5];return t[4]&&(n+="@supports (".concat(t[4],") {")),t[2]&&(n+="@media ".concat(t[2]," {")),s&&(n+="@layer".concat(t[5].length>0?" ".concat(t[5]):""," {")),n+=e(t),s&&(n+="}"),t[2]&&(n+="}"),t[4]&&(n+="}"),n})).join("")},t.i=function(e,n,s,i,a){"string"==typeof e&&(e=[[null,e,void 0]]);var r={};if(s)for(var o=0;o<this.length;o++){var d=this[o][0];null!=d&&(r[d]=!0)}for(var l=0;l<e.length;l++){var c=[].concat(e[l]);s&&r[c[0]]||(void 0!==a&&(void 0===c[5]||(c[1]="@layer".concat(c[5].length>0?" ".concat(c[5]):""," {").concat(c[1],"}")),c[5]=a),n&&(c[2]?(c[1]="@media ".concat(c[2]," {").concat(c[1],"}"),c[2]=n):c[2]=n),i&&(c[4]?(c[1]="@supports (".concat(c[4],") {").concat(c[1],"}"),c[4]=i):c[4]="".concat(i)),t.push(c))}},t}},417:e=>{e.exports=function(e,t){return t||(t={}),e?(e=String(e.__esModule?e.default:e),/^['"].*['"]$/.test(e)&&(e=e.slice(1,-1)),t.hash&&(e+=t.hash),/["'() \t\n]|(%20)/.test(e)||t.needQuotes?'"'.concat(e.replace(/"/g,'\\"').replace(/\n/g,"\\n"),'"'):e):e}},601:e=>{e.exports=function(e){return e[1]}},72:e=>{var t=[];function n(e){for(var n=-1,s=0;s<t.length;s++)if(t[s].identifier===e){n=s;break}return n}function s(e,s){for(var a={},r=[],o=0;o<e.length;o++){var d=e[o],l=s.base?d[0]+s.base:d[0],c=a[l]||0,h="".concat(l," ").concat(c);a[l]=c+1;var u=n(h),p={css:d[1],media:d[2],sourceMap:d[3],supports:d[4],layer:d[5]};if(-1!==u)t[u].references++,t[u].updater(p);else{var g=i(p,s);s.byIndex=o,t.splice(o,0,{identifier:h,updater:g,references:1})}r.push(h)}return r}function i(e,t){var n=t.domAPI(t);return n.update(e),function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap&&t.supports===e.supports&&t.layer===e.layer)return;n.update(e=t)}else n.remove()}}e.exports=function(e,i){var a=s(e=e||[],i=i||{});return function(e){e=e||[];for(var r=0;r<a.length;r++){var o=n(a[r]);t[o].references--}for(var d=s(e,i),l=0;l<a.length;l++){var c=n(a[l]);0===t[c].references&&(t[c].updater(),t.splice(c,1))}a=d}}},659:e=>{var t={};e.exports=function(e,n){var s=function(e){if(void 0===t[e]){var n=document.querySelector(e);if(window.HTMLIFrameElement&&n instanceof window.HTMLIFrameElement)try{n=n.contentDocument.head}catch(e){n=null}t[e]=n}return t[e]}(e);if(!s)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");s.appendChild(n)}},540:e=>{e.exports=function(e){var t=document.createElement("style");return e.setAttributes(t,e.attributes),e.insert(t,e.options),t}},56:(e,t,n)=>{e.exports=function(e){var t=n.nc;t&&e.setAttribute("nonce",t)}},825:e=>{e.exports=function(e){if("undefined"==typeof document)return{update:function(){},remove:function(){}};var t=e.insertStyleElement(e);return{update:function(n){!function(e,t,n){var s="";n.supports&&(s+="@supports (".concat(n.supports,") {")),n.media&&(s+="@media ".concat(n.media," {"));var i=void 0!==n.layer;i&&(s+="@layer".concat(n.layer.length>0?" ".concat(n.layer):""," {")),s+=n.css,i&&(s+="}"),n.media&&(s+="}"),n.supports&&(s+="}");var a=n.sourceMap;a&&"undefined"!=typeof btoa&&(s+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(a))))," */")),t.styleTagTransform(s,e,t.options)}(t,e,n)},remove:function(){!function(e){if(null===e.parentNode)return!1;e.parentNode.removeChild(e)}(t)}}}},113:e=>{e.exports=function(e,t){if(t.styleSheet)t.styleSheet.cssText=e;else{for(;t.firstChild;)t.removeChild(t.firstChild);t.appendChild(document.createTextNode(e))}}},724:(e,t,n)=>{e.exports=n.p+"assets/rs_school_logo.svg"},394:(e,t,n)=>{e.exports=n.p+"assets/send-icon.svg"}},t={};function n(s){var i=t[s];if(void 0!==i)return i.exports;var a=t[s]={id:s,exports:{}};return e[s](a,a.exports,n),a.exports}n.m=e,n.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return n.d(t,{a:t}),t},n.d=(e,t)=>{for(var s in t)n.o(t,s)&&!n.o(e,s)&&Object.defineProperty(e,s,{enumerable:!0,get:t[s]})},n.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{var e;n.g.importScripts&&(e=n.g.location+"");var t=n.g.document;if(!e&&t&&(t.currentScript&&(e=t.currentScript.src),!e)){var s=t.getElementsByTagName("script");if(s.length)for(var i=s.length-1;i>-1&&(!e||!/^http(s?):/.test(e));)e=s[i--].src}if(!e)throw new Error("Automatic publicPath is not supported in this browser");e=e.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),n.p=e})(),n.b=document.baseURI||self.location.href,n.nc=void 0,(()=>{function e(e){return null==e&&console.log(`${e} is not defined`),null!==e}class t{constructor(e,...t){this.children=[];const n=document.createElement(e.tag??"div");Object.assign(n,e),e.text&&(n.textContent=e.text),this.node=n,t&&this.appendChildren(t)}getNode(){return this.node}getChildren(){return this.children}append(e){e instanceof t?(this.node.append(e.getNode()),this.children.push(e)):this.node.append(e)}appendChildren(t){t.filter(e).forEach((e=>{this.append(e)}))}text(e){this.node.textContent=e}addClass(e){this.node.classList.add(e)}removeClass(e){this.node.classList.remove(e)}toggleClass(e){this.node.classList.toggle(e)}containsClass(e){return this.node.classList.contains(e)}setAttribute(e,t){this.node.setAttribute(e,t)}removeAttribute(e){this.node.removeAttribute(e)}addEventListener(e,t,n=!1){this.node.addEventListener(e,t,n)}removeEventListener(e,t,n=!1){this.node.removeEventListener(e,t,n)}deleteChildren(){this.children.forEach((e=>{e.deleteNode()})),this.children.length=0}deleteNode(){this.deleteChildren(),this.node.remove()}}var s=n(72),i=n.n(s),a=n(825),r=n.n(a),o=n(659),d=n.n(o),l=n(56),c=n.n(l),h=n(540),u=n.n(h),p=n(113),g=n.n(p),m=n(711),f={};f.styleTagTransform=g(),f.setAttributes=c(),f.insert=d().bind(null,"head"),f.domAPI=r(),f.insertStyleElement=u(),i()(m.A,f),m.A&&m.A.locals&&m.A.locals;class x extends t{constructor(){super({className:"connection-error__overlay"},new t({className:"connection-error__wrapper"},new t({className:"loader"}),new t({className:"connection-error__message"},new t({tag:"p",text:"Connection error"}),new t({tag:"p",text:"Trying to reconnect"}))))}}const w=new class{constructor(){this.errorMsg=new x,this.showErrorMsg(),this.socket=new WebSocket("ws://localhost:4000"),this.connect()}showErrorMsg(){const e=document.querySelector("body");e?.append(this.errorMsg.getNode()),e?.addEventListener("keydown",this.onErrorEventHandler)}hideErrorMsg(){this.errorMsg.getNode().remove();const e=document.querySelector("body");e?.removeEventListener("keydown",this.onErrorEventHandler)}onErrorEventHandler(e){"Tab"===e.key&&e.preventDefault()}connect(){this.socket=new WebSocket("ws://localhost:4000"),this.socket.onopen=()=>this.openHandler(),this.socket.onclose=()=>this.closeHandler(),this.socket.onerror=()=>this.errorHandler(),this.socket.onmessage=e=>this.messageHandler(e)}openHandler(){if(this.hideErrorMsg(),sessionStorage.getItem("curUserName")&&sessionStorage.getItem("curUserPassword")){const e=JSON.parse(sessionStorage.getItem("curUserName")),t=JSON.parse(sessionStorage.getItem("curUserPassword"));this.authUser(e,t)}}closeHandler(){this.showErrorMsg(),setTimeout((()=>this.connect()),500)}messageHandler(e){const t=JSON.parse(e.data);switch(t.type){case"USER_LOGIN":{const e=document.querySelector(".authorization-form"),t=document.querySelector(".fun-chat");e?e.dispatchEvent(new Event("successLogin")):t&&t.dispatchEvent(new Event("successLogin"));break}case"USER_LOGOUT":{sessionStorage.removeItem("curUserName"),sessionStorage.removeItem("curUserPassword");const e=document.querySelector(".fun-chat");e&&e.dispatchEvent(new Event("successLogout"));break}case"USER_ACTIVE":case"USER_INACTIVE":{const e=document.querySelector(".chat__users");e&&e.dispatchEvent(new CustomEvent("createUserList",{detail:{type:t.type,data:t.payload.users}}));break}case"USER_EXTERNAL_LOGIN":case"USER_EXTERNAL_LOGOUT":{const e=document.querySelector(".chat__users");e&&e.dispatchEvent(new CustomEvent("updateUserInList",{detail:{type:t.type,login:t.payload.user.login}}));const n=document.querySelector(".chat__window");n&&n.dispatchEvent(new CustomEvent("updateRecieverStatus",{detail:{type:t.type,login:t.payload.user.login}}));break}case"MSG_FROM_USER":t.id.startsWith("init")?document.querySelector(`.list__user[data-name='${t.id.slice(4)}']`).dispatchEvent(new CustomEvent("drawUnreadCounter",{detail:{data:t.payload.messages}})):document.querySelector(".chat__window").dispatchEvent(new CustomEvent("renderChat",{detail:{from:t.id,data:t.payload.messages}}));break;case"MSG_SEND":{const e=document.querySelector(".chat__window");if(e&&e.dispatchEvent(new CustomEvent("newMessage",{detail:{data:t.payload.message}})),null===t.id){const{from:e}=t.payload.message,n=document.querySelector(`.list__user[data-name='${e}']`);n&&n.dispatchEvent(new CustomEvent("newMessage",{detail:{data:t.payload.message}}))}break}case"MSG_DELIVER":{const e=document.querySelector(".chat__window");e&&e.dispatchEvent(new CustomEvent("updateMessageStatus",{detail:{type:"delivered",messageId:t.payload.message.id}}));break}case"MSG_READ":{const e=document.querySelector(".chat__window");e&&e.dispatchEvent(new CustomEvent("updateMessageStatus",{detail:{type:"read",messageId:t.payload.message.id}}));break}case"MSG_EDIT":{const e=document.querySelector(".chat__window");e&&e.dispatchEvent(new CustomEvent("updateMessageText",{detail:{type:"edited",messageId:t.payload.message.id,newText:t.payload.message.text}}));break}case"MSG_DELETE":{const e=document.querySelector(".chat__window");e&&e.dispatchEvent(new CustomEvent("deleteMessage",{detail:{messageId:t.payload.message.id}}));break}case"ERROR":{const e=document.querySelector("form"),n=document.querySelector(".fun-chat");"USER_LOGIN"===t.id&&e&&e.dispatchEvent(new CustomEvent("failedLogin",{detail:{error:t.payload.error}})),"USER_LOGOUT"===t.id&&n&&n.dispatchEvent(new CustomEvent("failedLogout",{detail:{error:t.payload.error}}));break}}}errorHandler(){console.error("Connection lost. Trying to reconnect")}authUser(e,t){const n={id:"USER_LOGIN",type:"USER_LOGIN",payload:{user:{login:e,password:t}}};this.socket.send(JSON.stringify(n))}logout(){const e={id:"USER_LOGOUT",type:"USER_LOGOUT",payload:{user:{login:JSON.parse(sessionStorage.getItem("curUserName")),password:JSON.parse(sessionStorage.getItem("curUserPassword"))}}};this.socket.send(JSON.stringify(e))}getAuthUsers(){this.socket.send(JSON.stringify({id:"USER_ACTIVE",type:"USER_ACTIVE",payload:null}))}getUnauthUsers(){this.socket.send(JSON.stringify({id:"USER_INACTIVE",type:"USER_INACTIVE",payload:null}))}getMessages(e,t){const n={id:"init"===t?`init${e}`:e,type:"MSG_FROM_USER",payload:{user:{login:e}}};this.socket.send(JSON.stringify(n))}sendMessage(e,t){const n={id:"MSG_SEND",type:"MSG_SEND",payload:{message:{to:e,text:t}}};this.socket.send(JSON.stringify(n))}setMessageRead(e){const t={id:"MSG_READ",type:"MSG_READ",payload:{message:{id:e}}};this.socket.send(JSON.stringify(t))}setMessageEdited(e,t){const n={id:"MSG_EDIT",type:"MSG_EDIT",payload:{message:{id:e,text:t}}};this.socket.send(JSON.stringify(n))}deleteMessage(e){const t={id:"MSG_DELETE",type:"MSG_DELETE",payload:{message:{id:e}}};this.socket.send(JSON.stringify(t))}};var _=n(133),b={};b.styleTagTransform=g(),b.setAttributes=c(),b.insert=d().bind(null,"head"),b.domAPI=r(),b.insertStyleElement=u(),i()(_.A,b),_.A&&_.A.locals&&_.A.locals;class v extends t{constructor(e){super({className:"overlay"},new t({className:"popup-auth-error"},new t({tag:"span",text:e}))),setTimeout((()=>this.deleteNode()),1500)}}const y=e=>new v(e);var E=n(823),S={};S.styleTagTransform=g(),S.setAttributes=c(),S.insert=d().bind(null,"head"),S.domAPI=r(),S.insertStyleElement=u(),i()(E.A,S),E.A&&E.A.locals&&E.A.locals;class N extends t{constructor(e,n){super({tag:"form",className:"authorization-form"}),this.InputName=new t({tag:"input",className:"auth-form__input",id:"name",name:"name",type:"text",placeholder:"Enter name",maxLength:18,pattern:"[a-zA-Z0-9]{4,}",title:"Letters or digits min 4 characters in length",autocomplete:"off",required:!0}),this.InputPassword=new t({tag:"input",className:"auth-form__input",id:"password",name:"password",type:"text",placeholder:"Enter password",pattern:"(?=^[a-zA-Z\\d]{6,}$)(?=.*\\d)(?=.*[a-z])(?=.*[A-Z]).*",title:"Lowercase AND uppercase letters AND digits. Min 6 characters",autocomplete:"off",required:!0}),this.ButtonSubmit=new t({tag:"button",className:"auth-form__button",type:"submit",text:"Enter chat",onclick:e=>this.submitHandler(e)}),this.ButtonAbout=new t({tag:"button",className:"auth-form__button",type:"button",text:"About",onclick:()=>n()}),this.appendChildren([new t({tag:"fieldset"},new t({tag:"legend",className:"auth-form__title",text:"Authorization"}),new t({className:"auth-form__input-wrapper"},new t({tag:"label",className:"auth-form__label",htmlFor:"name",text:"Nickname:"}),this.InputName),new t({className:"auth-form__input-wrapper"},new t({tag:"label",className:"auth-form__label",htmlFor:"password",text:"Password:"}),this.InputPassword)),this.ButtonAbout,this.ButtonSubmit]),this.addEventListener("successLogin",(()=>this.successLoginHandler(e))),this.addEventListener("failedLogin",(e=>this.failedLoginHandler(e)))}submitHandler(e){this.InputName.getNode().checkValidity()&&this.InputPassword.getNode().checkValidity()?(e.preventDefault(),w.authUser(this.InputName.getNode().value,this.InputPassword.getNode().value)):(this.InputName.addClass("error"),this.InputPassword.addClass("error"))}successLoginHandler(e){sessionStorage.setItem("curUserName",JSON.stringify(this.InputName.getNode().value)),sessionStorage.setItem("curUserPassword",JSON.stringify(this.InputPassword.getNode().value)),this.InputName.getNode().value="",this.InputPassword.getNode().value="",this.InputName.removeClass("error"),this.InputPassword.removeClass("error"),e()}failedLoginHandler(e){"incorrect password"===e.detail.error?this.append(y("Incorrect password")):this.append(y("A user with this login has already authorized")),this.ButtonSubmit.setAttribute("disabled","true"),this.ButtonAbout.setAttribute("disabled","true"),setTimeout((()=>{this.ButtonSubmit.removeAttribute("disabled"),this.ButtonAbout.removeAttribute("disabled")}),1500)}}var M=n(59),C={};C.styleTagTransform=g(),C.setAttributes=c(),C.insert=d().bind(null,"head"),C.domAPI=r(),C.insertStyleElement=u(),i()(M.A,C),M.A&&M.A.locals&&M.A.locals;class A extends t{constructor(e){super({tag:"header",className:"header"});const n=JSON.parse(sessionStorage.getItem("curUserName"));this.UserName=new t({tag:"span",className:"username",text:n}),this.ButtonAbout=new t({tag:"button",className:"link_about",text:"?",onclick:()=>e()}),this.ButtonLogout=new t({tag:"button",className:"header__button_logout",text:"Logout",onclick:()=>w.logout()}),this.appendChildren([new t({className:"title-wrapper"},new t({tag:"h1",className:"header__title",text:"Fun Chat"}),this.ButtonAbout),this.UserName,this.ButtonLogout])}}var k=n(15),I={};I.styleTagTransform=g(),I.setAttributes=c(),I.insert=d().bind(null,"head"),I.domAPI=r(),I.insertStyleElement=u(),i()(k.A,I),k.A&&k.A.locals&&k.A.locals;class U extends t{constructor(){super({tag:"footer",className:"footer"},new t({tag:"a",className:"footer__link link_git",href:"https://github.com/Koshman-Dmitri",target:"_blank",title:"GitHub",text:"Koshman-Dmitri"}),new t({className:"rs-school__wrapper"},new t({tag:"a",className:"link_rs-school",href:"https://rs.school/",target:"_blank",title:"RS.School"}),new t({tag:"p",className:"rs-school__title",text:"RS School"})),new t({tag:"time",dateTime:"2024",text:"Created in 2024"}))}}const T=new class{constructor(){this.store=[]}addMessage(e){this.store.push(e)}deleteMessage(e){const t=this.store.findIndex((t=>t.id===e));-1!==t&&this.store.splice(t,1)}findMessage(e){return this.store.find((t=>t.id===e))}};var L=n(36),R={};R.styleTagTransform=g(),R.setAttributes=c(),R.insert=d().bind(null,"head"),R.domAPI=r(),R.insertStyleElement=u(),i()(L.A,R),L.A&&L.A.locals&&L.A.locals;class D extends t{constructor(e,n){super({tag:"li",className:`list__user ${n}`},new t({className:"list__user-status"}),new t({tag:"span",className:"list__user-name",text:e})),this.userName=e,this.UnreadCounter=new t({className:"list__unwritten",text:""}),this.setAttribute("data-name",e),this.getNode().onclick=()=>w.getMessages(e),this.addEventListener("drawUnreadCounter",(e=>this.drawUnreadCounter(e))),this.addEventListener("newMessage",(e=>this.updateCounter("inc",e))),this.addEventListener("unwrittenWasDeleted",(()=>this.updateCounter("dec"))),this.addEventListener("resetUnreadCounter",(()=>this.deleteCounter()))}drawUnreadCounter(e){const t=e.detail.data.filter((e=>e.from===this.userName&&!e.status.isReaded));t.length&&(this.UnreadCounter.text(String(t.length)),this.append(this.UnreadCounter),t.forEach((e=>T.addMessage(e))))}updateCounter(e,t){const n=t;"inc"===e&&T.addMessage(n.detail.data),this.getChildren().includes(this.UnreadCounter)||this.append(this.UnreadCounter);const s=this.UnreadCounter.getNode().textContent;"inc"===e&&this.UnreadCounter.text(""+(+s+1)),"dec"===e&&(this.UnreadCounter.text(""+(+s-1)),"0"===this.UnreadCounter.getNode().textContent&&this.deleteCounter())}deleteCounter(){if(this.getChildren().includes(this.UnreadCounter)){this.UnreadCounter.text(""),this.UnreadCounter.deleteNode();const e=this.getChildren().findIndex((e=>e===this.UnreadCounter));this.getChildren().splice(e,1)}}}const W=(e,t)=>new D(e,t);var O=n(667),P={};P.styleTagTransform=g(),P.setAttributes=c(),P.insert=d().bind(null,"head"),P.domAPI=r(),P.insertStyleElement=u(),i()(O.A,P),O.A&&O.A.locals&&O.A.locals;class z extends t{constructor(){super({tag:"aside",className:"chat__users"}),this.activeUsers=[],this.inactiveUsers=[],this.Filter=new t({tag:"input",className:"chat__filter",type:"text",name:"find-user",placeholder:"Find...",autocomplete:"off",oninput:()=>this.filterUser()}),this.List=new t({tag:"ul",className:"users__list"}),this.appendChildren([this.Filter,this.List]),w.getAuthUsers(),w.getUnauthUsers(),this.addEventListener("createUserList",(e=>this.createList(e))),this.addEventListener("updateUserInList",(e=>this.updateUser(e)))}createList(e){const t=e;if("USER_ACTIVE"===t.detail.type){const e=JSON.parse(sessionStorage.getItem("curUserName"));this.activeUsers=t.detail.data.filter((t=>t.login!==e))}"USER_INACTIVE"===t.detail.type&&(this.inactiveUsers=t.detail.data),this.List.deleteChildren(),this.List.appendChildren([...this.activeUsers.map((e=>W(e.login,"online"))),...this.inactiveUsers.map((e=>W(e.login,"offline")))]),"USER_INACTIVE"===t.detail.type&&this.getEveryUsersHistory()}updateUser(e){const t=e;if("USER_EXTERNAL_LOGIN"===t.detail.type){const e=this.List.getChildren().find((e=>e.getNode().getAttribute("data-name")===t.detail.login));e?(e.removeClass("offline"),e.addClass("online")):(w.getAuthUsers(),w.getUnauthUsers())}if("USER_EXTERNAL_LOGOUT"===t.detail.type){const e=this.List.getChildren().find((e=>e.getNode().getAttribute("data-name")===t.detail.login));e?.removeClass("online"),e?.addClass("offline")}}filterUser(){const e=this.Filter.getNode().value.toLowerCase();this.List.getChildren().forEach((t=>{t.getNode().getAttribute("data-name")?.toLowerCase().includes(e)?t.removeClass("hidden"):t.addClass("hidden")}))}getEveryUsersHistory(){[...this.activeUsers,...this.inactiveUsers].forEach((e=>w.getMessages(e.login,"init")))}}var H=n(955),G={};G.styleTagTransform=g(),G.setAttributes=c(),G.insert=d().bind(null,"head"),G.domAPI=r(),G.insertStyleElement=u(),i()(H.A,G),H.A&&H.A.locals&&H.A.locals;const F=new t({className:"delimeter",text:"New messages"});var B=n(35),q={};q.styleTagTransform=g(),q.setAttributes=c(),q.insert=d().bind(null,"head"),q.domAPI=r(),q.insertStyleElement=u(),i()(B.A,q),B.A&&B.A.locals&&B.A.locals;class ${constructor(e,n,s){let i;this.node=null,this.nodeStatus=null,this.id=e.id,this.from=e.from,this.to=e.to,this.text=e.text,this.datetime=e.datetime,this.status={isDelivered:e.status.isDelivered,isReaded:e.status.isReaded,isEdited:e.status.isEdited},this.nodeText=new t({className:"message__text",text:e.text}).getNode(),this.nodeEdit=new t({tag:"span",className:"message__edit",text:e.status.isEdited?"Edited":""}).getNode(),i=this.status.isReaded?"Read":this.status.isDelivered?"Delivered":"Sent",this.nodeStatus=new t({tag:"span",className:"message__status",text:"in"===n?"":i}).getNode(),this.nodeDirection=n,this.rightClickHandler=s}render(){const e=new t({className:`message ${this.nodeDirection}`},new t({className:"message__header"},new t({tag:"span",className:"message__username",text:this.from}),new t({tag:"span",className:"message__data",text:this.makeDate(this.datetime)})),this.nodeText,new t({className:"message__footer"},this.nodeEdit,this.nodeStatus));return e.containsClass("out")&&(e.getNode().oncontextmenu=e=>{e.preventDefault();const t=e.currentTarget;this.rightClickHandler(this.id,t.offsetTop)}),this.node=e,e}editMessage(e){this.nodeText&&(this.nodeText.textContent=e)}changeStatusToDelivered(){this.nodeStatus&&!this.status.isDelivered&&(this.nodeStatus.textContent="Delivered",this.status.isDelivered=!0)}changeStatusToRead(){this.nodeStatus&&!this.status.isReaded&&("out"===this.nodeDirection&&(this.nodeStatus.textContent="Read"),this.status.isReaded=!0)}changeStatusToEdited(){this.nodeEdit&&!this.status.isEdited&&(this.nodeEdit.textContent="Edited",this.status.isEdited=!0)}makeDate(e){const t=new Date(e);return`${t.getDate()}.${t.getMonth()+1}.${t.getFullYear()}, ${String(t.getHours()).padStart(2,"0")}:${String(t.getMinutes()).padStart(2,"0")}:${String(t.getSeconds()).padStart(2,"0")}`}}const j=(e,t,n)=>new $(e,t,n);var J=n(341),V={};V.styleTagTransform=g(),V.setAttributes=c(),V.insert=d().bind(null,"head"),V.domAPI=r(),V.insertStyleElement=u(),i()(J.A,V),J.A&&J.A.locals&&J.A.locals;class X extends t{constructor(){super({tag:"aside",className:"chat__window"}),this.currentReciever="",this.currentMessages=[],this.Reciever=new t({tag:"span",className:"reciever__name"}),this.RecieverStatus=new t({className:"reciever__status"}),this.StartMessage=new t({tag:"label",className:"chat__start-message",text:"Choose user to send a message..."}),this.MainWindow=new t({className:"window__main"}),this.MainWindow.getNode().onclick=()=>{this.doReadenStatus(),this.MainWindow.getChildren().includes(this.PopupMenu)&&this.hideContextMenu()},this.MainWindow.getNode().onwheel=()=>this.doReadenStatus(),this.MainWindow.append(this.StartMessage),this.Form=new t({tag:"form",className:"window__footer"}),this.MsgInput=new t({tag:"input",className:"message-input",type:"text",placeholder:"Your message",disabled:!0,oninput:()=>{this.MsgInput.getNode().value.length>0?this.SendBtn.removeAttribute("disabled"):this.SendBtn.setAttribute("disabled","true")}}),this.CancelEditBtn=new t({tag:"label",className:"cancel-edit hidden",text:"X",onclick:()=>this.cancelEdit()}),this.SendBtn=new t({tag:"button",className:"message-button-send",type:"submit",disabled:!0,onclick:e=>{this.doReadenStatus(),this.sendMsgHandler(e)}}),this.Form.appendChildren([this.MsgInput,this.CancelEditBtn,this.SendBtn]),this.Delimeter=F,this.appendChildren([new t({className:"window__header"},this.Reciever,this.RecieverStatus),this.MainWindow,this.Form]),this.PopupMenu=new t({className:"popup-context"},new t({tag:"span",text:"Edit",onclick:()=>this.editMessage()}),new t({tag:"span",text:"Delete",onclick:()=>this.deleteMessage()})),this.chosenMsgId="",this.inputEditMode=!1,this.addEventListener("renderChat",(e=>this.renderChat(e))),this.addEventListener("updateRecieverStatus",(e=>this.changeRecieverStatus(e))),this.addEventListener("newMessage",(e=>this.messageHandler(e))),this.addEventListener("updateMessageStatus",(e=>this.updateMsgStatus(e))),this.addEventListener("updateMessageText",(e=>this.updateMsgText(e))),this.addEventListener("deleteMessage",(e=>this.updateDeletedMsg(e))),this.addEventListener("mainWindowClick",(()=>{this.MainWindow.getChildren().includes(this.PopupMenu)&&this.hideContextMenu()}))}renderChat(e){const t=e;this.currentReciever=t.detail.from,this.updateReciever(t.detail.from),this.MsgInput.removeAttribute("disabled"),this.MsgInput.getNode().value="",this.SendBtn.setAttribute("disabled","true"),this.inputEditMode&&this.cancelEdit(),this.updateChat(t.detail.data)}updateReciever(e){this.Reciever.text(e);const t=document.querySelector(`.list__user[data-name='${e}']`);t?.classList.contains("online")?(this.RecieverStatus.text("Online"),this.RecieverStatus.addClass("reciever__status_online"),this.RecieverStatus.removeClass("reciever__status_offline")):(this.RecieverStatus.text("Offline"),this.RecieverStatus.addClass("reciever__status_offline"),this.RecieverStatus.removeClass("reciever__status_online"))}updateChat(e){if(this.MainWindow.deleteChildren(),this.MainWindow.getChildren().length=0,this.currentMessages.length=0,0===e.length)return this.MainWindow.append(this.StartMessage),void this.StartMessage.text("Text your first message");let t,n=!1;e.forEach((e=>{const t=e.to===this.currentReciever?"out":"in",s=j(e,t,this.showContextMenu.bind(this));this.currentMessages.push(s),e.from!==this.currentReciever||e.status.isReaded||n||(n=!0,this.MainWindow.append(this.Delimeter)),this.MainWindow.append(s.render())}));const s=Number.parseInt(getComputedStyle(this.MainWindow.getNode()).paddingTop,10);t=n?this.Delimeter.getNode().offsetTop-s:this.MainWindow.getChildren()[this.MainWindow.getChildren().length-1].getNode().offsetTop-s,this.MainWindow.getNode().scrollTo({top:t,behavior:"smooth"})}changeRecieverStatus(e){const t=e;t.detail.login===this.currentReciever&&("USER_EXTERNAL_LOGIN"===t.detail.type&&(this.RecieverStatus.text("Online"),this.RecieverStatus.addClass("reciever__status_online"),this.RecieverStatus.removeClass("reciever__status_offline")),"USER_EXTERNAL_LOGOUT"===t.detail.type&&(this.RecieverStatus.text("Offline"),this.RecieverStatus.addClass("reciever__status_offline"),this.RecieverStatus.removeClass("reciever__status_online")))}sendMsgHandler(e){e.preventDefault();const t=this.MsgInput.getNode().value;this.inputEditMode?(this.cancelEdit(),w.setMessageEdited(this.chosenMsgId,t),this.chosenMsgId=""):w.sendMessage(this.currentReciever,t),this.MsgInput.getNode().value="",this.SendBtn.setAttribute("disabled","true")}messageHandler(e){const t=e.detail.data;if(t.to===this.currentReciever||t.from===this.currentReciever){if(this.MainWindow.getChildren().includes(this.StartMessage)){this.StartMessage.deleteNode();const e=this.MainWindow.getChildren().findIndex((e=>e===this.StartMessage));this.MainWindow.getChildren().splice(e,1)}const e=t.to===this.currentReciever?"out":"in";"in"===e&&this.addDelimeter();const n=j(t,e,this.showContextMenu.bind(this));this.MainWindow.append(n.render()),this.currentMessages.push(n);let s=0;if(this.MainWindow.getChildren().find((e=>e.containsClass("delimeter")))){const e=Number.parseInt(getComputedStyle(this.MainWindow.getNode()).paddingTop,10);s=this.Delimeter.getNode().offsetTop-e}else s=this.MainWindow.getChildren()[this.MainWindow.getChildren().length-1].getNode().offsetTop;this.MainWindow.getNode().scrollTo({top:s,behavior:"smooth"})}}addDelimeter(){this.MainWindow.getChildren().find((e=>e.containsClass("delimeter")))||this.MainWindow.append(this.Delimeter)}removeDelimeter(){if(this.MainWindow.getChildren().find((e=>e.containsClass("delimeter")))){this.Delimeter.deleteNode();const e=this.MainWindow.getChildren().findIndex((e=>e===this.Delimeter));this.MainWindow.getChildren().splice(e,1);const t=this.MainWindow.getChildren()[this.MainWindow.getChildren().length-1].getNode().offsetTop;this.MainWindow.getNode().scrollTo({top:t,behavior:"smooth"})}}doReadenStatus(){this.MainWindow.getChildren().find((e=>e.containsClass("delimeter")))&&(this.removeDelimeter(),this.currentReciever&&document.querySelector(`.list__user[data-name='${this.currentReciever}']`).dispatchEvent(new Event("resetUnreadCounter")),this.currentMessages.filter((e=>e.from===this.currentReciever&&!e.status.isReaded)).forEach((e=>w.setMessageRead(e.id))))}updateMsgStatus(e){const t=e;if("delivered"===t.detail.type){const e=this.currentMessages.find((e=>e.id===t.detail.messageId));e?.changeStatusToDelivered()}if("read"===t.detail.type){const e=this.currentMessages.find((e=>e.id===t.detail.messageId));e?.changeStatusToRead(),T.deleteMessage(t.detail.messageId)}if("edited"===t.detail.type){const e=this.currentMessages.find((e=>e.id===t.detail.messageId));e?.changeStatusToEdited()}}showContextMenu(e,t){this.PopupMenu.getNode().style.top=`${t+6}px`,this.MainWindow.append(this.PopupMenu),this.chosenMsgId=e}hideContextMenu(){this.PopupMenu.getNode().remove();const e=this.MainWindow.getChildren().findIndex((e=>e===this.PopupMenu));this.MainWindow.getChildren().splice(e,1)}editMessage(){const e=this.currentMessages.find((e=>e.id===this.chosenMsgId));this.MsgInput.getNode().value=e?.text,this.MsgInput.getNode().focus(),this.CancelEditBtn.removeClass("hidden"),this.SendBtn.removeAttribute("disabled"),this.inputEditMode=!0}cancelEdit(){this.MsgInput.getNode().value="",this.CancelEditBtn.addClass("hidden"),this.SendBtn.setAttribute("disabled","true"),this.inputEditMode=!1}updateMsgText(e){const t=e,n=this.currentMessages.find((e=>e.id===t.detail.messageId));n?.editMessage(t.detail.newText),this.updateMsgStatus(e)}deleteMessage(){w.deleteMessage(this.chosenMsgId)}updateDeletedMsg(e){const t=e,n=this.currentMessages.find((e=>e.id===t.detail.messageId));if(n){n.node?.deleteNode();const e=this.MainWindow.getChildren().findIndex((e=>e===n.node));this.MainWindow.getChildren().splice(e,1);const s=this.currentMessages.findIndex((e=>e.id===t.detail.messageId));if(-1!==s&&this.currentMessages.splice(s,1),this.inputEditMode&&this.cancelEdit(),this.MainWindow.getChildren()[this.MainWindow.getChildren().length-1]===this.Delimeter&&(this.Delimeter.deleteNode(),this.MainWindow.getChildren().pop()),0===this.MainWindow.getChildren().length&&(this.StartMessage.text("Text your first message"),this.MainWindow.append(this.StartMessage)),!n.status.isReaded){const e=document.querySelector(`.list__user[data-name='${n.from}']`);e&&e.dispatchEvent(new Event("unwrittenWasDeleted")),T.deleteMessage(t.detail.messageId)}}else{const e=T.findMessage(t.detail.messageId),n=document.querySelector(`.list__user[data-name='${e?.from}']`);n&&n.dispatchEvent(new Event("unwrittenWasDeleted"))}}}var Y=n(547),K={};K.styleTagTransform=g(),K.setAttributes=c(),K.insert=d().bind(null,"head"),K.domAPI=r(),K.insertStyleElement=u(),i()(Y.A,K),Y.A&&Y.A.locals&&Y.A.locals;class Z extends t{constructor(e,n,s){super({className:"fun-chat",onclick:()=>this.Chat.getNode().dispatchEvent(new Event("mainWindowClick"))}),this.Header=(e=>new A(e))(n),this.UserList=new z,this.Chat=new X;const i=new t({tag:"main",className:"chat"},this.UserList,this.Chat);this.Footer=new U,this.appendChildren([this.Header,i,this.Footer]),this.addEventListener("successLogin",s),this.addEventListener("successLogout",e),this.addEventListener("failedLogout",(e=>this.failedLogoutHandler(e)))}failedLogoutHandler(e){"a user with this login is already authorized"===e.detail.error?this.append(y("A user with this login is already authorized")):this.append(y("Take your hands off the storage!"))}}var Q=n(319),ee={};ee.styleTagTransform=g(),ee.setAttributes=c(),ee.insert=d().bind(null,"head"),ee.domAPI=r(),ee.insertStyleElement=u(),i()(Q.A,ee),Q.A&&Q.A.locals&&Q.A.locals;class te extends t{constructor(e){super({className:"about"},new t({tag:"h2",className:"about__title",text:"Fun Chat"}));const n=new t({tag:"p",className:"about__description"});n.getNode().innerHTML='<span class="description__accent">By Koshman-Dmitri</span><br><br>Lorem ipsum, dolor sit amet consectetur adipisicing elit. <span class="description__accent">Fun</span> Quaerat\n    voluptates <span class="description__accent">WebSocket protocol</span> voluptate, corrupti quibusdam molestias\n    laborum deserunt unde, assumenda, <span class="description__accent">Chat</span> delectus impedit\n    <span class="description__accent">Incredible</span> beatae cum facere\n    <span class="description__accent">Help</span> inventore ipsam praesentium ullam? In, error\n    <span class="description__accent">So Fun</span> asperiores.';const s=new t({tag:"button",className:"about__button",text:"Back",onclick:()=>e()});this.appendChildren([n,s])}}var ne=n(987),se={};se.styleTagTransform=g(),se.setAttributes=c(),se.insert=d().bind(null,"head"),se.domAPI=r(),se.insertStyleElement=u(),i()(ne.A,se),ne.A&&ne.A.locals&&ne.A.locals;class ie extends t{constructor(e){super({className:"page-not-found"});const n=new t({tag:"h2",className:"not-found__title",innerText:"404 \n Not found"}),s=new t({tag:"p",className:"not-found__description",text:"Make sure that the hash matches the URL (#login, #main, #about)"}),i=new t({tag:"button",className:"not-found__button",text:"Back",onclick:()=>e()});this.appendChildren([n,s,i])}}var ae=n(186),re={};re.styleTagTransform=g(),re.setAttributes=c(),re.insert=d().bind(null,"head"),re.domAPI=r(),re.insertStyleElement=u(),i()(ae.A,re),ae.A&&ae.A.locals&&ae.A.locals;const oe=document.querySelector("body"),de=new t({className:"container"});oe.append(de.getNode());const le=new class{constructor(e){this.root=e,window.addEventListener("hashchange",(()=>this.routing()))}start(){this.routing()}showMain(){this.root.deleteChildren(),this.root.append(new Z((()=>this.routeFromUI("#login")),(()=>this.routeFromUI("#about")),(()=>this.routeFromUI("#main"))))}showLoginPage(){this.root.deleteChildren(),this.root.append(new N((()=>this.routeFromUI("#main")),(()=>this.routeFromUI("#about"))))}showAboutPage(){var e;this.root.deleteChildren(),this.root.append((e=this.backHandler.bind(this),new te(e)))}showNotFoundPage(){var e;this.root.deleteChildren(),this.root.append((e=this.backHandler.bind(this),new ie(e)))}backHandler(){window.history.back()}routeFromUI(e){window.history.pushState(null,"",e),this.routing()}routing(){let e=window.location.hash;switch(""!==e&&"#login"!==e&&"#main"!==e||(e=this.checkIsAuth()),e){case"#login":this.showLoginPage();break;case"#about":this.showAboutPage();break;case"#main":this.showMain();break;default:this.showNotFoundPage()}}checkIsAuth(){return sessionStorage.getItem("curUserName")&&sessionStorage.getItem("curUserPassword")?(window.history.replaceState(null,"","#main"),"#main"):(window.history.replaceState(null,"","#login"),"#login")}}(de),ce=setInterval((()=>{1===w.socket.readyState&&(clearInterval(ce),le.start())}),100)})()})();